import{a as H,M as oe}from"./minors-DzstKTHx.js";import{g as ue,r as N}from"./minors-hAoqoQLA.js";import{u as re}from"./street-OEI7EWH8.js";import{J as se,d as ae,K as ie,L as de,c as S,r as x,w as J,h as g,a as E,o as m,f as n,b as A,g as s,F as U,z as Q,p as _,m as f,t as X,E as me,C as h,u as I,M as C,N as Y,O as Z,P as pe,Q as ce,T as ve,U as fe,V as _e,W as ye}from"./index-B9CILD_j.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as ee}from"./MultiFileInput-BkOVnpey.js";async function ge(){const o=await se("/api/data/get-areas",{method:"GET"});if(o&&o.status===200&&o.data){const{data:F}=o.data;return F}else return[]}const Ve={class:"multiple-textarea"},xe={class:"operators"},Ee={class:"section"},Me={class:"section"},be={class:"input-mode-btns"},ke={key:1,class:"show-area"},we=ae({__name:"MultipleTextarea",props:ie({inputMode:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const F=o,u=de(o,"modelValue"),t=S(()=>!!F.inputMode),v=x("");J(u,(d,a)=>{(!a||Array.isArray(a)&&!a.length)&&Array.isArray(d)&&d.length&&(v.value=d[0].key)},{immediate:!0});const V=S({get(){if(!u.value||!Array.isArray(u.value))return"";const d=u.value.find(a=>a.key===v.value);return d?d.text:""},set(d){if(!u.value||!Array.isArray(u.value))return;const a=u.value.find(y=>y.key===v.value);if(a)a.text=d;else return}}),i=x([]);async function K(){i.value=await ge()}const c=x({key:"",text:""}),b=x(),M=x(!1),z=()=>{M.value=!0,i.value.length||K()},B=()=>{M.value=!1,b.value?.clearValidate()},O=()=>{c.value.key="",c.value.text="",B()},P=()=>{z()},W=()=>{b.value&&b.value.validate(d=>{d?(Array.isArray(u.value)||(u.value=[]),u.value.push({key:c.value.key,text:c.value.text}),B(),v.value=c.value.key):me({message:"请修正填写错误项后再提交~",type:"warning"})})},G=()=>{if(!Array.isArray(u.value))return;const d=u.value.findIndex(a=>a.key===v.value);d!==-1&&(u.value.splice(d,1),v.value=u.value.length?u.value[0].key:"")},L={key:[{trigger:"blur",validator:(d,a,y)=>{u.value?.findIndex(k=>k.key===a)!==-1?y(new Error("当前索引已经被使用，请换一个不重复的索引")):y()}},{trigger:"change",require:!0,message:"索引不能为空"}]};return(d,a)=>{const y=g("ElOption"),k=g("ElSelect"),R=g("ElFormItem"),T=g("ElInput"),$=g("ElForm"),w=g("ElButton"),j=g("ElDialog");return m(),E("div",Ve,[n(j,{"append-to-body":"",modelValue:M.value,"onUpdate:modelValue":a[2]||(a[2]=r=>M.value=r),title:"新增记录",width:"500","close-on-click-modal":!1},{footer:s(()=>[A("div",xe,[n(w,{onClick:O},{default:s(()=>a[5]||(a[5]=[f("取消添加",-1)])),_:1,__:[5]}),n(w,{type:"success",onClick:W},{default:s(()=>a[6]||(a[6]=[f("确认添加",-1)])),_:1,__:[6]})])]),default:s(()=>[n($,{ref_key:"addFormRef",ref:b,model:c.value,"label-width":"auto",rules:L},{default:s(()=>[n(R,{label:"ID",prop:"key"},{default:s(()=>[n(k,{modelValue:c.value.key,"onUpdate:modelValue":a[0]||(a[0]=r=>c.value.key=r)},{default:s(()=>[(m(!0),E(U,null,Q(i.value,r=>(m(),_(y,{key:r.id,value:r.name,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(R,{label:"内容",prop:"text"},{default:s(()=>[n(T,{type:"textarea",autosize:{minRows:2,maxRows:6},resize:"none",placeholder:"在这里编辑关注内容",modelValue:c.value.text,"onUpdate:modelValue":a[1]||(a[1]=r=>c.value.text=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),A("div",Ee,[n(k,{modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=r=>v.value=r),placeholder:"请选择一条记录..."},{default:s(()=>[(m(!0),E(U,null,Q(u.value,r=>(m(),_(y,{key:r.key,value:r.key},{default:s(()=>[f(X(r.key),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),A("div",Me,[t.value?(m(),E(U,{key:0},[n(T,{class:"text-editor",type:"textarea",placeholder:"在这里编辑关注内容",autosize:{minRows:2,maxRows:6},resize:"both",modelValue:V.value,"onUpdate:modelValue":a[4]||(a[4]=r=>V.value=r)},null,8,["modelValue"]),A("div",be,[n(w,{onClick:P},{default:s(()=>a[7]||(a[7]=[f("新增记录",-1)])),_:1,__:[7]}),n(w,{onClick:G},{default:s(()=>a[8]||(a[8]=[f("删除记录",-1)])),_:1,__:[8]})])],64)):(m(),E("div",ke,X(V.value),1))])])}}}),te=ne(we,[["__scopeId","data-v-cb80f117"]]);function We(o){return["street","community"].includes(o)}function Ie(o){return o==="tempProtect"}function Ce(o){return o==="street"}function Ae(o){return o==="community"}function Fe(o){return o==="warningStatus"}function Se(o){return o==="registratedWuhou"}function Ue(o){return o==="gender"||o==="guardianGender"}const Be={key:0,class:"operators"},Oe={class:"railway"},Re={class:"minor-input"};function le(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!ye(o)}const Te=ae({__name:"MinorInput",props:{inputMode:{type:Boolean},form:{}},emits:["submit","view-psy-test","update:form","download"],setup(o,{emit:F}){const u=o,t=x(u.form||ue()),v=x(t.value),V=F;J(t,e=>{V("update:form",e)},{deep:!0});const i=x(!!u.inputMode);J(i,e=>{e&&(v.value=Y(t.value))});const K=S(()=>i.value?H.filter(e=>e.editor!=="complex"&&e.key!=="age"&&e.key!=="guardianAge"):H.slice());function c(){V("submit",t.value),i.value=!1}function b(){V("view-psy-test")}function M(){t.value=Y(v.value)}function z(){i.value=!0}function B(){M(),i.value=!1}const{StreetMap:O,CommunityMap:P,getNameByCommunityId:W,getNameByStreetId:G,streets:L}=re(),d=e=>Ie(e)?t.value[e]?"是":"否":Ce(e)?G(t.value[e]):Ae(e)?W(t.value[e]):Fe(e)?N.warningStatus[t.value[e]]:Se(e)?N.registratedWuhou[t.value[e]]:Ue(e)?N.gender[t.value[e]]:t.value[e],a=S(()=>t.value.street&&O[t.value.street]?O[t.value.street].communities.map(e=>P[e]):[]),y=S(()=>L),k=e=>e==="street"?y.value:a.value,R=e=>e.getTime()>Date.now(),T={input:e=>n(Z,{modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),date:e=>n(_e,{modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l,disabledDate:R},null),select:e=>{let l;return n(fe,{modelValue:t.value[e],"onUpdate:modelValue":p=>t.value[e]=p},le(l=k(e).map(p=>n(ve,{key:p.id,value:p.id,label:p.name},null)))?l:{default:()=>[l]})},radio:e=>{let l;return n(ce,{modelValue:t.value[e],"onUpdate:modelValue":p=>t.value[e]=p},le(l=N[e].map((p,q)=>n(pe,{value:q,label:p},null)))?l:{default:()=>[l]})},textarea:e=>n(Z,{type:"textarea",modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),textareas:e=>n(te,{inputMode:i.value,modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),file:e=>n(ee,{inputMode:i.value,files:t.value[e],"onUpdate:files":l=>t.value[e]=l},null),complex:()=>{}},$={input:e=>n("span",null,[t.value[e]]),select:e=>n("span",null,[d(e)]),date:e=>n("span",null,[t.value[e]]),radio:e=>n("span",null,[d(e)]),textarea:e=>n("div",{class:"text-info"},[t.value[e]]),textareas:e=>n(te,{inputMode:i.value,modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),file:e=>n(ee,{"has-download":!0,inputMode:i.value,files:t.value[e],"onUpdate:files":l=>t.value[e]=l},null),complex:()=>n(C,{onClick:b},{default:()=>[f("查看详情")]})},w=({"minor-item":e})=>{const{key:l,editor:p}=e||{};return l&&p?T[p](l):null},j=({"minor-item":e})=>{const{key:l,editor:p}=e||{};return l&&p?$[p](l):null},r=()=>{V("download")};return(e,l)=>{const p=g("ElFormItem"),q=g("ElForm");return m(),E(U,null,[u.inputMode?h("",!0):(m(),E("div",Be,[A("div",Oe,[i.value?(m(),_(I(C),{key:0,onClick:B,class:"btn"},{default:s(()=>l[0]||(l[0]=[f("放弃",-1)])),_:1,__:[0]})):(m(),_(I(C),{key:1,onClick:z,type:"primary",class:"btn"},{default:s(()=>l[1]||(l[1]=[f("编辑",-1)])),_:1,__:[1]})),i.value?(m(),_(I(C),{key:2,type:"warning",onClick:M,class:"btn"},{default:s(()=>l[2]||(l[2]=[f("重置",-1)])),_:1,__:[2]})):h("",!0),i.value?(m(),_(I(C),{key:3,type:"primary",onClick:c,class:"btn"},{default:s(()=>l[3]||(l[3]=[f("保存",-1)])),_:1,__:[3]})):h("",!0),i.value?h("",!0):(m(),_(I(C),{key:4,onClick:r,class:"btn"},{default:s(()=>l[4]||(l[4]=[f("下载",-1)])),_:1,__:[4]}))])])),A("div",Re,[n(q,{class:"content",model:t.value,"label-width":"auto"},{default:s(()=>[(m(!0),E(U,null,Q(K.value,D=>(m(),_(p,{key:D.key,label:I(oe)[D.key]},{default:s(()=>[i.value?(m(),_(w,{key:0,"minor-item":D},null,8,["minor-item"])):(m(),_(j,{key:1,"minor-item":D},null,8,["minor-item"]))]),_:2},1032,["label"]))),128))]),_:1},8,["model"])])],64)}}}),Ge=ne(Te,[["__scopeId","data-v-bce1665e"]]);export{Ge as M,Fe as a,We as i};
