import{a as z,M as X,r as Y}from"./minors-D72bfAYt.js";import{a as Z}from"./minors-BNGPOB-r.js";import{d as H,C as ee,D as te,c as h,r as x,w as j,j as f,a as V,o as d,g as a,b as I,h as i,f as c,F as A,G as J,B as y,t as L,E as le,i as O,u as b,H as C,I as $,J as K,K as oe,L as ae,M as ne}from"./index-COYtomWE.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as P}from"./MultiFileInput-BQrdZzvc.js";const ue={class:"multiple-textarea"},re={class:"operators"},se={class:"section"},ie={class:"section"},de={class:"input-mode-btns"},me={key:1,class:"show-area"},pe=H({__name:"MultipleTextarea",props:ee({inputMode:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const F=_,u=te(_,"modelValue"),o=h(()=>!!F.inputMode),p=x("");j(u,(r,t)=>{(!t||Array.isArray(t)&&!t.length)&&Array.isArray(r)&&r.length&&(p.value=r[0].key)},{immediate:!0});const k=h({get(){if(!u.value||!Array.isArray(u.value))return"";const r=u.value.find(t=>t.key===p.value);return r?r.text:""},set(r){if(!u.value||!Array.isArray(u.value))return;const t=u.value.find(v=>v.key===p.value);if(t)t.text=r;else return}}),n=x({key:"",text:""}),M=x(),E=x(!1),B=()=>{E.value=!0},w=()=>{E.value=!1,M.value?.clearValidate()},R=()=>{n.value.key="",n.value.text="",w()},U=()=>{B()},S=()=>{M.value&&M.value.validate(r=>{r?(Array.isArray(u.value)||(u.value=[]),u.value.push({key:n.value.key,text:n.value.text}),w(),p.value=n.value.key):le({message:"请修正填写错误项后再提交~",type:"warning"})})},T=()=>{if(!Array.isArray(u.value))return;const r=u.value.findIndex(t=>t.key===p.value);r!==-1&&(u.value.splice(r,1),p.value=u.value.length?u.value[0].key:"")},N={key:[{trigger:"blur",validator:(r,t,v)=>{u.value?.findIndex(e=>e.key===t)!==-1?v(new Error("当前索引已经被使用，请换一个不重复的索引")):v()}},{trigger:"change",require:!0,message:"索引不能为空"}]};return(r,t)=>{const v=f("ElInput"),e=f("ElFormItem"),l=f("ElForm"),s=f("ElButton"),D=f("ElDialog"),g=f("ElOption"),W=f("ElSelect");return d(),V("div",ue,[a(D,{"append-to-body":"",modelValue:E.value,"onUpdate:modelValue":t[2]||(t[2]=m=>E.value=m),title:"新增记录",width:"500","close-on-click-modal":!1},{footer:i(()=>[I("div",re,[a(s,{onClick:R},{default:i(()=>t[5]||(t[5]=[c("取消添加",-1)])),_:1,__:[5]}),a(s,{type:"success",onClick:S},{default:i(()=>t[6]||(t[6]=[c("确认添加",-1)])),_:1,__:[6]})])]),default:i(()=>[a(l,{ref_key:"addFormRef",ref:M,model:n.value,"label-width":"auto",rules:N},{default:i(()=>[a(e,{label:"ID",prop:"key"},{default:i(()=>[a(v,{modelValue:n.value.key,"onUpdate:modelValue":t[0]||(t[0]=m=>n.value.key=m),placeholder:"在这里编辑内容的索引"},null,8,["modelValue"])]),_:1}),a(e,{label:"内容",prop:"text"},{default:i(()=>[a(v,{type:"textarea",autosize:{minRows:2,maxRows:6},resize:"none",placeholder:"在这里编辑关注内容",modelValue:n.value.text,"onUpdate:modelValue":t[1]||(t[1]=m=>n.value.text=m)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),I("div",se,[a(W,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=m=>p.value=m),placeholder:"请选择一条记录..."},{default:i(()=>[(d(!0),V(A,null,J(u.value,m=>(d(),y(g,{key:m.key,value:m.key},{default:i(()=>[c(L(m.key),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),I("div",ie,[o.value?(d(),V(A,{key:0},[a(v,{class:"text-editor",type:"textarea",placeholder:"在这里编辑关注内容",autosize:{minRows:2,maxRows:6},resize:"both",modelValue:k.value,"onUpdate:modelValue":t[4]||(t[4]=m=>k.value=m)},null,8,["modelValue"]),I("div",de,[a(s,{onClick:U},{default:i(()=>t[7]||(t[7]=[c("新增记录",-1)])),_:1,__:[7]}),a(s,{onClick:T},{default:i(()=>t[8]||(t[8]=[c("删除记录",-1)])),_:1,__:[8]})])],64)):(d(),V("div",me,L(k.value),1))])])}}}),G=Q(pe,[["__scopeId","data-v-63596480"]]),ve={key:0,class:"operators"},ce={class:"railway"},fe={class:"minor-input"};function q(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!ne(_)}const _e=H({__name:"MinorInput",props:{inputMode:{type:Boolean},form:{}},emits:["submit","view-psy-test","update:form"],setup(_,{emit:F}){const u=_,o=x(u.form||Z()),p=x(o.value),k=F;j(o,e=>{k("update:form",e)},{deep:!0});const n=x(!!u.inputMode);j(n,e=>{e&&(p.value=$(o.value))});const M=h(()=>n.value?z.filter(e=>e.editor!=="complex"):z.slice());function E(){k("submit",o.value),n.value=!1}function B(){k("view-psy-test")}function w(){o.value=$(p.value)}function R(){n.value=!0}function U(){w(),n.value=!1}function S(e){return e==="tempProtect"}const T=e=>S(e)?o.value[e]?"是":"否":o.value[e],N={input:e=>a(K,{modelValue:o.value[e],"onUpdate:modelValue":l=>o.value[e]=l},null),radio:e=>{let l;return a(ae,{modelValue:o.value[e],"onUpdate:modelValue":s=>o.value[e]=s},q(l=Y[e].map(s=>a(oe,{value:s},q(s)?s:{default:()=>[s]})))?l:{default:()=>[l]})},textarea:e=>a(K,{type:"textarea",modelValue:o.value[e],"onUpdate:modelValue":l=>o.value[e]=l},null),textareas:e=>a(G,{inputMode:n.value,modelValue:o.value[e],"onUpdate:modelValue":l=>o.value[e]=l},null),file:e=>a(P,{inputMode:n.value,files:o.value[e],"onUpdate:files":l=>o.value[e]=l},null),complex:()=>{}},r={input:e=>a("span",null,[o.value[e]]),radio:e=>a("span",null,[T(e)]),textarea:e=>a("div",{class:"text-info"},[o.value[e]]),textareas:e=>a(G,{inputMode:n.value,modelValue:o.value[e],"onUpdate:modelValue":l=>o.value[e]=l},null),file:e=>a(P,{"has-download":!0,inputMode:n.value,files:o.value[e],"onUpdate:files":l=>o.value[e]=l},null),complex:()=>a(C,{onClick:B},{default:()=>[c("查看详情")]})},t=({"minor-item":e})=>{const{key:l,editor:s}=e;return N[s](l)},v=({"minor-item":e})=>{const{key:l,editor:s}=e;return r[s](l)};return(e,l)=>{const s=f("ElFormItem"),D=f("ElForm");return d(),V(A,null,[u.inputMode?O("",!0):(d(),V("div",ve,[I("div",ce,[n.value?(d(),y(b(C),{key:0,onClick:U,class:"btn"},{default:i(()=>l[0]||(l[0]=[c("放弃",-1)])),_:1,__:[0]})):(d(),y(b(C),{key:1,onClick:R,type:"primary",class:"btn"},{default:i(()=>l[1]||(l[1]=[c("编辑",-1)])),_:1,__:[1]})),n.value?(d(),y(b(C),{key:2,type:"warning",onClick:w,class:"btn"},{default:i(()=>l[2]||(l[2]=[c("重置",-1)])),_:1,__:[2]})):O("",!0),n.value?(d(),y(b(C),{key:3,type:"primary",onClick:E,class:"btn"},{default:i(()=>l[3]||(l[3]=[c("保存",-1)])),_:1,__:[3]})):O("",!0)])])),I("div",fe,[a(D,{class:"content",model:o.value,"label-width":"auto"},{default:i(()=>[(d(!0),V(A,null,J(M.value,g=>(d(),y(s,{key:g.key,label:b(X)[g.key]},{default:i(()=>[n.value?(d(),y(t,{key:0,"minor-item":g},null,8,["minor-item"])):(d(),y(v,{key:1,"minor-item":g},null,8,["minor-item"]))]),_:2},1032,["label"]))),128))]),_:1},8,["model"])])],64)}}}),Ee=Q(_e,[["__scopeId","data-v-2ae6f82a"]]);export{Ee as M};
