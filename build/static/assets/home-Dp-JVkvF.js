import{d as S,m as N,r as m,u as W,c as C,w as R,o as Y,a as P,b as Q,n as I,e as v,f as k,T as j,g as h,h as $,i as A,j as z,v as G,t as F,k as V,l as J,p as E,q as K,s as X,x as Z}from"./index-BR5oj7Uf.js";import{u as B}from"./table--w7vm-AR.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import ee from"./Statics-BKQDZg3L.js";import te from"./MinorsList-QCebwU7N.js";import ae from"./QaList--j3S5L5A.js";import"./minors-mXhleVk2.js";import"./utils-BW_ZrKIj.js";import"./PieChart-CzaQWRx3.js";import"./installCanvasRenderer-BWIarJz0.js";import"./street-Dw46nwSk.js";import"./minors-DzstKTHx.js";import"./MinorInput-33xcfTiD.js";import"./MultiFileInput-DNs63xtC.js";const ne=2e3,oe=S({__name:"RowPages",props:N({loop:{type:Boolean},pageQueryKeys:{}},{index:{default:0},indexModifiers:{}}),emits:["update:index"],setup(L){const r=L,g=V(),i=J(),t=m(),a=W(L,"index"),c=m([]);let f=[];const u=m(innerHeight),y=m(0),d=C(()=>a.value===0?0:c.value.filter((e,n)=>n<a.value).reduce((e,n)=>e+n,0));let o=0;function s(e){return!!e&&Array.isArray(e)&&!!e.length&&typeof e[0]!="string"}function l(e){return typeof e=="string"?e:e.key}const p=m(!1);let w=0;function O(){clearTimeout(w),p.value=!0,w=window.setTimeout(()=>{p.value=!1},ne)}const q=C(()=>{const e=r.pageQueryKeys;return s(e)&&a.value<e.length?e[a.value].name:""});R(()=>i.query.row_page_key,e=>{if(!r.pageQueryKeys||!r.pageQueryKeys.length)return;const n=r.pageQueryKeys.findIndex(_=>l(_)===e);n>=0&&(a.value=n)},{immediate:!0}),R(a,e=>{if(!(!r.pageQueryKeys||!r.pageQueryKeys.length||e>=r.pageQueryKeys.length)&&(g.replace({query:{...i.query,row_page_key:l(r.pageQueryKeys[e])}}),t.value)){const n=()=>{O(),t.value?.removeEventListener("transitionend",n)};t.value.addEventListener("transitionend",n)}},{immediate:!0});function M(){if(!t.value)return;t.value.style.transition="transform .5s ease-in";const e=()=>{t.value&&(t.value.style.transition="",t.value.removeEventListener("transitionend",e))};t.value.addEventListener("transitionend",e)}const{getLocker:D}=B("scroll");E("page-down",()=>{const e=D();if(console.log(e),e)return;M();let n=a.value+1;n>=o&&(r.loop?n=n%o:n=o-1),a.value=n}),E("page-up",()=>{if(D())return;M();let n=a.value-1;n<0&&(r.loop?n=o-1:n=0),a.value=n}),E("active-index",e=>f[a.value]===e);let T=!1,U=0,x=new ResizeObserver(()=>{if(clearTimeout(U),T){T=!1;return}U=window.setTimeout(()=>{if(!t.value)return;const e=Array.from(t.value.children).filter(_=>_.classList.contains("row-page-item"));if(o=e.length,o===0)return;a.value>=o&&(a.value=o-1),c.value=e.map(_=>_.clientHeight),f=e.slice();const n=c.value[a.value];y.value=a.value===0?0:c.value[a.value-1],u.value=n,T=!0})});return Y(()=>{t.value&&x&&(x.observe(t.value),t.value.style.transition="none")}),P(()=>{x?.disconnect(),x=null}),(e,n)=>(A(),Q("div",{class:"row-pages",style:I({"--row-page-root-height":`${u.value}`,height:`${u.value}px`})},[v(j,null,{default:h(()=>[z(k("div",{class:"row-page-title"},F(q.value),513),[[G,p.value]])]),_:1}),k("div",{ref_key:"contRef",ref:t,class:"content",style:I({transform:`translateY(${-1*d.value}px)`})},[$(e.$slots,"default",{},void 0,!0)],4)],4))}}),se=H(oe,[["__scopeId","data-v-4a07cba3"]]),le=S({__name:"RowPageItem",setup(L){const r=K("page-down",()=>{console.log("page down")}),g=K("page-up",()=>{console.log("page up")}),i=K("active-index",()=>!1),t=m();let a=0,c=-1,f=!1,u=!1;const y=()=>{if(!t.value||!i(t.value))return;const s=t.value.scrollTop;c=t.value.scrollHeight-t.value.clientHeight;const l=Math.abs(c-s)<2,p=Math.abs(s-0)<2;l&&a<=s&&(f=!0),p&&a>=s&&(u=!0),!l&&!p&&(f=!1,u=!1),a=s};function d(s){if(!t.value||!i(t.value))return;const{deltaY:l}=s;l<0?(u||a===0)&&(g(),u=!1):(f||c!==0&&a===c)&&(r(),f=!1)}window.addEventListener("wheel",d);function o(s){if(!t.value||!i(t.value))return;const{key:l,ctrlKey:p,altKey:w}=s;l==="ArrowUp"&&!p&&!w&&u&&(g(),u=!1),l==="ArrowDown"&&!p&&!w&&f&&(r(),f=!1)}return window.addEventListener("keyup",o),P(()=>{window.removeEventListener("wheel",d),window.removeEventListener("keyup",o)}),(s,l)=>(A(),Q("div",{ref_key:"contRef",ref:t,class:"row-page-item",onScroll:y},[$(s.$slots,"default",{},void 0,!0)],544))}}),b=H(le,[["__scopeId","data-v-4b143c86"]]),re={class:"home"},ie=S({__name:"home",setup(L){const r=[{key:"static",name:"数据概览"},{key:"minors",name:"服务记录"},{key:"inventory",name:"量表库"}],g=V(),i=m(0),t=m(!1),{lock:a,unLock:c}=B("scroll");R(t,d=>{d?a():c()});function f(){t.value=!1,Z()===0&&g.replace("/auth")}function u(){t.value=!1,g.push("/auth?modify_password=true")}const y=d=>{const{key:o,ctrlKey:s,altKey:l}=d;o==="Escape"&&!s&&!l&&(t.value=!0),o==="1"?i.value=0:o==="2"?i.value=1:o==="3"&&(i.value=2)};return window.addEventListener("keyup",y),P(()=>{window.removeEventListener("keyup",y)}),(d,o)=>{const s=X("ElDialog");return A(),Q("div",re,[v(s,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),width:"360",modal:!1,class:"cyber-dlg",title:"系统操作"},{default:h(()=>[k("div",{class:"system-btns"},[k("div",{class:"cyber-btn",onClick:u},"修改密码"),k("div",{class:"cyber-btn",onClick:f},"退出系统")])]),_:1},8,["modelValue"]),v(se,{class:"pages",index:i.value,"onUpdate:index":o[1]||(o[1]=l=>i.value=l),"page-query-keys":r},{default:h(()=>[v(b,null,{default:h(()=>[v(ee)]),_:1}),v(b,null,{default:h(()=>[v(te)]),_:1}),v(b,null,{default:h(()=>[v(ae)]),_:1})]),_:1},8,["index"])])}}}),xe=H(ie,[["__scopeId","data-v-25216300"]]);export{xe as default};
