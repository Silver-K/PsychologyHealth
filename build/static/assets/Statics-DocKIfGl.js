import{a as ra,S as oe,h as na,i as ht,r as yt}from"./minors-DKTootAl.js";import{b as Ue,p as He}from"./utils-DdpY_R0b.js";import{b6 as N,b7 as mt,ab as Re,b8 as Mt,z as kt,a_ as bt,b9 as xt,ba as Xe,F as ia,aO as oa,aL as sa,bb as la,bc as ca,bd as de,ah as xe,G as tt,be as ua,i as Oe,Y as va,aE as ce,bf as he,e as U,bg as ga,E as Pe,bh as at,bi as fa,bj as pa,bk as da,aY as ha,ax as ye,R as rt,av as be,bl as ya,bm as ma,ai as ct,_ as ae,j as Fe,B as ba,b1 as Me,bn as xa,c as Bt,g as Et,bo as Sa,aK as ut,w as Y,x as La,aj as Nt,N as Ca,P as St,b as J,bp as _a,aB as Z,bq as Da,aW as ke,aC as Ft,br as Lt,bs as Aa,bt as wa,bu as me,ao as Ta,bv as Pa,as as Ia,bw as Ga,u as Ra,bx as Oa,v as Ma,by as ka,aQ as nt,bz as zt,ap as Be,bA as Ba,bB as Ea,bC as Na,n as Fa,bD as za,aP as Vt,bE as Va,aU as Wa,aw as Ya,aS as Ua,aD as Ha,ay as Xa,bF as ja,p as $a,f as qa,bG as Ka,bH as Za,aI as Ja,bI as Qa,bJ as er,bK as tr,b2 as ar,b3 as rr,b4 as nr,b5 as ir}from"./installCanvasRenderer-CUFePUtV.js";import{d as Wt,r as te,w as je,a as Ie,o as Ge,b as L,a3 as Ct,m as se,t as Ce,u as $e,f as _t,h as or,F as sr,z as lr,A as cr,n as ur,J as vr}from"./index-BRyNBdtL.js";import{_ as Yt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as gr}from"./street-DRnnkt2p.js";var fe=Math.PI*2,ee=sa.CMD,fr=["top","right","bottom","left"];function pr(n,a,t,e,r){var o=t.width,i=t.height;switch(n){case"top":e.set(t.x+o/2,t.y-a),r.set(0,-1);break;case"bottom":e.set(t.x+o/2,t.y+i+a),r.set(0,1);break;case"left":e.set(t.x-a,t.y+i/2),r.set(-1,0);break;case"right":e.set(t.x+o+a,t.y+i/2),r.set(1,0);break}}function dr(n,a,t,e,r,o,i,l,c){i-=n,l-=a;var v=Math.sqrt(i*i+l*l);i/=v,l/=v;var s=i*t+n,y=l*t+a;if(Math.abs(e-r)%fe<1e-4)return c[0]=s,c[1]=y,v-t;if(o){var d=e;e=de(r),r=de(d)}else e=de(e),r=de(r);e>r&&(r+=fe);var u=Math.atan2(l,i);if(u<0&&(u+=fe),u>=e&&u<=r||u+fe>=e&&u+fe<=r)return c[0]=s,c[1]=y,v-t;var p=t*Math.cos(e)+n,f=t*Math.sin(e)+a,g=t*Math.cos(r)+n,h=t*Math.sin(r)+a,m=(p-i)*(p-i)+(f-l)*(f-l),b=(g-i)*(g-i)+(h-l)*(h-l);return m<b?(c[0]=p,c[1]=f,Math.sqrt(m)):(c[0]=g,c[1]=h,Math.sqrt(b))}function Ee(n,a,t,e,r,o,i,l){var c=r-n,v=o-a,s=t-n,y=e-a,d=Math.sqrt(s*s+y*y);s/=d,y/=d;var u=c*s+v*y,p=u/d;l&&(p=Math.min(Math.max(p,0),1)),p*=d;var f=i[0]=n+p*s,g=i[1]=a+p*y;return Math.sqrt((f-r)*(f-r)+(g-o)*(g-o))}function Ut(n,a,t,e,r,o,i){t<0&&(n=n+t,t=-t),e<0&&(a=a+e,e=-e);var l=n+t,c=a+e,v=i[0]=Math.min(Math.max(r,n),l),s=i[1]=Math.min(Math.max(o,a),c);return Math.sqrt((v-r)*(v-r)+(s-o)*(s-o))}var j=[];function hr(n,a,t){var e=Ut(a.x,a.y,a.width,a.height,n.x,n.y,j);return t.set(j[0],j[1]),e}function yr(n,a,t){for(var e=0,r=0,o=0,i=0,l,c,v=1/0,s=a.data,y=n.x,d=n.y,u=0;u<s.length;){var p=s[u++];u===1&&(e=s[u],r=s[u+1],o=e,i=r);var f=v;switch(p){case ee.M:o=s[u++],i=s[u++],e=o,r=i;break;case ee.L:f=Ee(e,r,s[u],s[u+1],y,d,j,!0),e=s[u++],r=s[u++];break;case ee.C:f=ca(e,r,s[u++],s[u++],s[u++],s[u++],s[u],s[u+1],y,d,j),e=s[u++],r=s[u++];break;case ee.Q:f=la(e,r,s[u++],s[u++],s[u],s[u+1],y,d,j),e=s[u++],r=s[u++];break;case ee.A:var g=s[u++],h=s[u++],m=s[u++],b=s[u++],C=s[u++],x=s[u++];u+=1;var _=!!(1-s[u++]);l=Math.cos(C)*m+g,c=Math.sin(C)*b+h,u<=1&&(o=l,i=c);var A=(y-g)*b/m+g;f=dr(g,h,b,C,C+x,_,A,d,j),e=Math.cos(C+x)*m+g,r=Math.sin(C+x)*b+h;break;case ee.R:o=e=s[u++],i=r=s[u++];var S=s[u++],D=s[u++];f=Ut(o,i,S,D,y,d,j);break;case ee.Z:f=Ee(e,r,o,i,y,d,j,!0),e=o,r=i;break}f<v&&(v=f,t.set(j[0],j[1]))}return v}var $=new N,w=new N,I=new N,K=new N,q=new N;function Dt(n,a){if(n){var t=n.getTextGuideLine(),e=n.getTextContent();if(e&&t){var r=n.textGuideLineConfig||{},o=[[0,0],[0,0],[0,0]],i=r.candidates||fr,l=e.getBoundingRect().clone();l.applyTransform(e.getComputedTransform());var c=1/0,v=r.anchor,s=n.getComputedTransform(),y=s&&ia([],s),d=a.get("length2")||0;v&&I.copy(v);for(var u=0;u<i.length;u++){var p=i[u];pr(p,0,l,$,K),N.scaleAndAdd(w,$,K,d),w.transform(y);var f=n.getBoundingRect(),g=v?v.distance(w):n instanceof oa?yr(w,n.path,I):hr(w,f,I);g<c&&(c=g,w.transform(s),I.transform(s),I.toArray(o[0]),w.toArray(o[1]),$.toArray(o[2]))}Ht(o,a.get("minTurnAngle")),t.setShape({points:o})}}}var Ne=[],W=new N;function Ht(n,a){if(a<=180&&a>0){a=a/180*Math.PI,$.fromArray(n[0]),w.fromArray(n[1]),I.fromArray(n[2]),N.sub(K,$,w),N.sub(q,I,w);var t=K.len(),e=q.len();if(!(t<.001||e<.001)){K.scale(1/t),q.scale(1/e);var r=K.dot(q),o=Math.cos(a);if(o<r){var i=Ee(w.x,w.y,I.x,I.y,$.x,$.y,Ne,!1);W.fromArray(Ne),W.scaleAndAdd(q,i/Math.tan(Math.PI-a));var l=I.x!==w.x?(W.x-w.x)/(I.x-w.x):(W.y-w.y)/(I.y-w.y);if(isNaN(l))return;l<0?N.copy(W,w):l>1&&N.copy(W,I),W.toArray(n[1])}}}}function mr(n,a,t){if(t<=180&&t>0){t=t/180*Math.PI,$.fromArray(n[0]),w.fromArray(n[1]),I.fromArray(n[2]),N.sub(K,w,$),N.sub(q,I,w);var e=K.len(),r=q.len();if(!(e<.001||r<.001)){K.scale(1/e),q.scale(1/r);var o=K.dot(a),i=Math.cos(t);if(o<i){var l=Ee(w.x,w.y,I.x,I.y,$.x,$.y,Ne,!1);W.fromArray(Ne);var c=Math.PI/2,v=Math.acos(q.dot(a)),s=c+v-t;if(s>=c)N.copy(W,I);else{W.scaleAndAdd(q,l/Math.tan(Math.PI/2-s));var y=I.x!==w.x?(W.x-w.x)/(I.x-w.x):(W.y-w.y)/(I.y-w.y);if(isNaN(y))return;y<0?N.copy(W,w):y>1&&N.copy(W,I)}W.toArray(n[1])}}}}function qe(n,a,t,e){var r=t==="normal",o=r?n:n.ensureState(t);o.ignore=a;var i=e.get("smooth");i&&i===!0&&(i=.3),o.shape=o.shape||{},i>0&&(o.shape.smooth=i);var l=e.getModel("lineStyle").getLineStyle();r?n.useStyle(l):o.style=l}function br(n,a){var t=a.smooth,e=a.points;if(e)if(n.moveTo(e[0][0],e[0][1]),t>0&&e.length>=3){var r=xt(e[0],e[1]),o=xt(e[1],e[2]);if(!r||!o){n.lineTo(e[1][0],e[1][1]),n.lineTo(e[2][0],e[2][1]);return}var i=Math.min(r,o)*t,l=Xe([],e[1],e[0],i/r),c=Xe([],e[1],e[2],i/o),v=Xe([],l,c,.5);n.bezierCurveTo(l[0],l[1],l[0],l[1],v[0],v[1]),n.bezierCurveTo(c[0],c[1],c[0],c[1],e[2][0],e[2][1])}else for(var s=1;s<e.length;s++)n.lineTo(e[s][0],e[s][1])}function Xt(n,a,t){var e=n.getTextGuideLine(),r=n.getTextContent();if(!r){e&&n.removeTextGuideLine();return}for(var o=a.normal,i=o.get("show"),l=r.ignore,c=0;c<mt.length;c++){var v=mt[c],s=a[v],y=v==="normal";if(s){var d=s.get("show"),u=y?l:Re(r.states[v]&&r.states[v].ignore,l);if(u||!Re(d,i)){var p=y?e:e&&e.states[v];p&&(p.ignore=!0),e&&qe(e,!0,v,s);continue}e||(e=new Mt,n.setTextGuideLine(e),!y&&(l||!i)&&qe(e,!0,"normal",a.normal),n.stateProxy&&(e.stateProxy=n.stateProxy)),qe(e,!1,v,s)}}if(e){kt(e.style,t),e.style.fill=null;var f=o.get("showAbove"),g=n.textGuideLineConfig=n.textGuideLineConfig||{};g.showAbove=f||!1,e.buildPath=br}}function jt(n,a){a=a||"labelLine";for(var t={normal:n.getModel(a)},e=0;e<bt.length;e++){var r=bt[e];t[r]=n.getModel([r,a])}return t}function xr(n){if(n){for(var a=[],t=0;t<n.length;t++)a.push(n[t].slice());return a}}function Sr(n,a){var t=n.label,e=a&&a.getTextGuideLine();return{dataIndex:n.dataIndex,dataType:n.dataType,seriesIndex:n.seriesModel.seriesIndex,text:n.label.style.text,rect:n.hostRect,labelRect:n.rect,align:t.style.align,verticalAlign:t.style.verticalAlign,labelLinePoints:xr(e&&e.shape.points)}}var At=["align","verticalAlign","width","height","fontSize"],V=new ua,Ke=xe(),Lr=xe();function _e(n,a,t){for(var e=0;e<t.length;e++){var r=t[e];a[r]!=null&&(n[r]=a[r])}}var De=["x","y","rotation"],Cr=function(){function n(){this._labelList=[],this._chartViewList=[]}return n.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},n.prototype._addLabel=function(a,t,e,r,o){var i=r.style,l=r.__hostTarget,c=l.textConfig||{},v=r.getComputedTransform(),s=r.getBoundingRect().plain();tt.applyTransform(s,s,v),v?V.setLocalTransform(v):(V.x=V.y=V.rotation=V.originX=V.originY=0,V.scaleX=V.scaleY=1),V.rotation=de(V.rotation);var y=r.__hostTarget,d;if(y){d=y.getBoundingRect().plain();var u=y.getComputedTransform();tt.applyTransform(d,d,u)}var p=d&&y.getTextGuideLine();this._labelList.push({label:r,labelLine:p,seriesModel:e,dataIndex:a,dataType:t,layoutOptionOrCb:o,layoutOption:null,rect:s,hostRect:d,priority:d?d.width*d.height:0,defaultAttr:{ignore:r.ignore,labelGuideIgnore:p&&p.ignore,x:V.x,y:V.y,scaleX:V.scaleX,scaleY:V.scaleY,rotation:V.rotation,style:{x:i.x,y:i.y,align:i.align,verticalAlign:i.verticalAlign,width:i.width,height:i.height,fontSize:i.fontSize},cursor:r.cursor,attachedPos:c.position,attachedRot:c.rotation}})},n.prototype.addLabelsOfSeries=function(a){var t=this;this._chartViewList.push(a);var e=a.__model,r=e.get("labelLayout");(Oe(r)||va(r).length)&&a.group.traverse(function(o){if(o.ignore)return!0;var i=o.getTextContent(),l=ce(o);i&&!i.disableLabelLayout&&t._addLabel(l.dataIndex,l.dataType,e,i,r)})},n.prototype.updateLayoutConfig=function(a){var t=a.getWidth(),e=a.getHeight();function r(b,C){return function(){Dt(b,C)}}for(var o=0;o<this._labelList.length;o++){var i=this._labelList[o],l=i.label,c=l.__hostTarget,v=i.defaultAttr,s=void 0;Oe(i.layoutOptionOrCb)?s=i.layoutOptionOrCb(Sr(i,c)):s=i.layoutOptionOrCb,s=s||{},i.layoutOption=s;var y=Math.PI/180;c&&c.setTextConfig({local:!1,position:s.x!=null||s.y!=null?null:v.attachedPos,rotation:s.rotate!=null?s.rotate*y:v.attachedRot,offset:[s.dx||0,s.dy||0]});var d=!1;if(s.x!=null?(l.x=he(s.x,t),l.setStyle("x",0),d=!0):(l.x=v.x,l.setStyle("x",v.style.x)),s.y!=null?(l.y=he(s.y,e),l.setStyle("y",0),d=!0):(l.y=v.y,l.setStyle("y",v.style.y)),s.labelLinePoints){var u=c.getTextGuideLine();u&&(u.setShape({points:s.labelLinePoints}),d=!1)}var p=Ke(l);p.needsUpdateLabelLine=d,l.rotation=s.rotate!=null?s.rotate*y:v.rotation,l.scaleX=v.scaleX,l.scaleY=v.scaleY;for(var f=0;f<At.length;f++){var g=At[f];l.setStyle(g,s[g]!=null?s[g]:v.style[g])}if(s.draggable){if(l.draggable=!0,l.cursor="move",c){var h=i.seriesModel;if(i.dataIndex!=null){var m=i.seriesModel.getData(i.dataType);h=m.getItemModel(i.dataIndex)}l.on("drag",r(c,h.getModel("labelLine")))}}else l.off("drag"),l.cursor=v.cursor}},n.prototype.layout=function(a){var t=a.getWidth(),e=a.getHeight(),r=[];U(this._labelList,function(c){c.defaultAttr.ignore||r.push(ga({},c))});var o=Pe(r,function(c){return c.layoutOption.moveOverlap==="shiftX"}),i=Pe(r,function(c){return c.layoutOption.moveOverlap==="shiftY"});at(o,0,0,t),at(i,1,0,e);var l=Pe(r,function(c){return c.layoutOption.hideOverlap});fa(l),pa(l)},n.prototype.processLabelsOverall=function(){var a=this;U(this._chartViewList,function(t){var e=t.__model,r=t.ignoreLabelLineUpdate,o=e.isAnimationEnabled();t.group.traverse(function(i){if(i.ignore&&!i.forceLabelAnimation)return!0;var l=!r,c=i.getTextContent();!l&&c&&(l=Ke(c).needsUpdateLabelLine),l&&a._updateLabelLine(i,e),o&&a._animateLabels(i,e)})})},n.prototype._updateLabelLine=function(a,t){var e=a.getTextContent(),r=ce(a),o=r.dataIndex;if(e&&o!=null){var i=t.getData(r.dataType),l=i.getItemModel(o),c={},v=i.getItemVisual(o,"style");if(v){var s=i.getVisual("drawType");c.stroke=v[s]}var y=l.getModel("labelLine");Xt(a,jt(l),c),Dt(a,y)}},n.prototype._animateLabels=function(a,t){var e=a.getTextContent(),r=a.getTextGuideLine();if(e&&(a.forceLabelAnimation||!e.ignore&&!e.invisible&&!a.disableLabelAnimation&&!da(a))){var o=Ke(e),i=o.oldLayout,l=ce(a),c=l.dataIndex,v={x:e.x,y:e.y,rotation:e.rotation},s=t.getData(l.dataType);if(i){e.attr(i);var d=a.prevStates;d&&(rt(d,"select")>=0&&e.attr(o.oldLayoutSelect),rt(d,"emphasis")>=0&&e.attr(o.oldLayoutEmphasis)),be(e,v,t,c)}else if(e.attr(v),!ha(e).valueAnimation){var y=Re(e.style.opacity,1);e.style.opacity=0,ye(e,{style:{opacity:y}},t,c)}if(o.oldLayout=v,e.states.select){var u=o.oldLayoutSelect={};_e(u,v,De),_e(u,e.states.select,De)}if(e.states.emphasis){var p=o.oldLayoutEmphasis={};_e(p,v,De),_e(p,e.states.emphasis,De)}ya(e,c,s,t,t)}if(r&&!r.ignore&&!r.invisible){var o=Lr(r),i=o.oldLayout,f={points:r.shape.points};i?(r.attr({shape:i}),be(r,{shape:f},t)):(r.setShape(f),r.style.strokePercent=0,ye(r,{style:{strokePercent:1}},t)),o.oldLayout=f}},n}(),Ze=xe();function _r(n){n.registerUpdateLifecycle("series:beforeupdate",function(a,t,e){var r=Ze(t).labelManager;r||(r=Ze(t).labelManager=new Cr),r.clearLabels()}),n.registerUpdateLifecycle("series:layoutlabels",function(a,t,e){var r=Ze(t).labelManager;e.updatedSeries.forEach(function(o){r.addLabelsOfSeries(t.getViewOfSeriesModel(o))}),r.updateLayoutConfig(t),r.layout(t),r.processLabelsOverall()})}function Dr(n,a){var t=ma(a.get("padding")),e=a.getItemStyle(["color","opacity"]);e.fill=a.get("backgroundColor");var r=new ct({shape:{x:n.x-t[3],y:n.y-t[0],width:n.width+t[1]+t[3],height:n.height+t[0]+t[2],r:a.get("borderRadius")},style:e,silent:!0,z2:-1});return r}var Ar=function(n,a){if(a==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(a==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},it=function(n){ae(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=a.type,t.layoutMode={type:"box",ignoreSize:!0},t}return a.prototype.init=function(t,e,r){this.mergeDefaultAndTheme(t,r),t.selected=t.selected||{},this._updateSelector(t)},a.prototype.mergeOption=function(t,e){n.prototype.mergeOption.call(this,t,e),this._updateSelector(t)},a.prototype._updateSelector=function(t){var e=t.selector,r=this.ecModel;e===!0&&(e=t.selector=["all","inverse"]),Fe(e)&&U(e,function(o,i){Me(o)&&(o={type:o}),e[i]=ba(o,Ar(r,o.type))})},a.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&this.get("selectedMode")==="single"){for(var e=!1,r=0;r<t.length;r++){var o=t[r].get("name");if(this.isSelected(o)){this.select(o),e=!0;break}}!e&&this.select(t[0].get("name"))}},a.prototype._updateData=function(t){var e=[],r=[];t.eachRawSeries(function(c){var v=c.name;r.push(v);var s;if(c.legendVisualProvider){var y=c.legendVisualProvider,d=y.getAllNames();t.isSeriesFiltered(c)||(r=r.concat(d)),d.length?e=e.concat(d):s=!0}else s=!0;s&&xa(c)&&e.push(c.name)}),this._availableNames=r;var o=this.get("data")||e,i=Bt(),l=Et(o,function(c){return(Me(c)||ut(c))&&(c={name:c}),i.get(c.name)?null:(i.set(c.name,!0),new Sa(c,this,this.ecModel))},this);this._data=Pe(l,function(c){return!!c})},a.prototype.getData=function(){return this._data},a.prototype.select=function(t){var e=this.option.selected,r=this.get("selectedMode");if(r==="single"){var o=this._data;U(o,function(i){e[i.get("name")]=!1})}e[t]=!0},a.prototype.unSelect=function(t){this.get("selectedMode")!=="single"&&(this.option.selected[t]=!1)},a.prototype.toggleSelected=function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},a.prototype.allSelect=function(){var t=this._data,e=this.option.selected;U(t,function(r){e[r.get("name",!0)]=!0})},a.prototype.inverseSelect=function(){var t=this._data,e=this.option.selected;U(t,function(r){var o=r.get("name",!0);e.hasOwnProperty(o)||(e[o]=!0),e[o]=!e[o]})},a.prototype.isSelected=function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&rt(this._availableNames,t)>=0},a.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},a.type="legend.plain",a.dependencies=["series"],a.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",bottom:Y.size.m,align:"auto",backgroundColor:Y.color.transparent,borderColor:Y.color.border,borderRadius:0,borderWidth:0,padding:5,itemGap:8,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:Y.color.disabled,inactiveBorderColor:Y.color.disabled,inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:Y.color.disabled,inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:Y.color.secondary},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:Y.color.tertiary,borderWidth:1,borderColor:Y.color.border},emphasis:{selectorLabel:{show:!0,color:Y.color.quaternary}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1},triggerEvent:!1},a}(La),le=J,ot=U,Ae=Nt,$t=function(n){ae(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=a.type,t.newlineDisabled=!1,t}return a.prototype.init=function(){this.group.add(this._contentGroup=new Ae),this.group.add(this._selectorGroup=new Ae),this._isFirstRender=!0},a.prototype.getContentGroup=function(){return this._contentGroup},a.prototype.getSelectorGroup=function(){return this._selectorGroup},a.prototype.render=function(t,e,r){var o=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!t.get("show",!0)){var i=t.get("align"),l=t.get("orient");(!i||i==="auto")&&(i=t.get("left")==="right"&&l==="vertical"?"right":"left");var c=t.get("selector",!0),v=t.get("selectorPosition",!0);c&&(!v||v==="auto")&&(v=l==="horizontal"?"end":"start"),this.renderInner(i,t,e,r,c,l,v);var s=Ca(t,r).refContainer,y=t.getBoxLayoutParams(),d=t.get("padding"),u=St(y,s,d),p=this.layoutInner(t,i,u,o,c,v),f=St(kt({width:p.width,height:p.height},y),s,d);this.group.x=f.x-p.x,this.group.y=f.y-p.y,this.group.markRedraw(),this.group.add(this._backgroundEl=Dr(p,t))}},a.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},a.prototype.renderInner=function(t,e,r,o,i,l,c){var v=this.getContentGroup(),s=Bt(),y=e.get("selectedMode"),d=e.get("triggerEvent"),u=[];r.eachRawSeries(function(p){!p.get("legendHoverLink")&&u.push(p.id)}),ot(e.getData(),function(p,f){var g=this,h=p.get("name");if(!this.newlineDisabled&&(h===""||h===`
`)){var m=new Ae;m.newline=!0,v.add(m);return}var b=r.getSeriesByName(h)[0];if(!s.get(h))if(b){var C=b.getData(),x=C.getVisual("legendLineStyle")||{},_=C.getVisual("legendIcon"),A=C.getVisual("style"),S=this._createItem(b,h,f,p,e,t,x,A,_,y,o);S.on("click",le(wt,h,null,o,u)).on("mouseover",le(st,b.name,null,o,u)).on("mouseout",le(lt,b.name,null,o,u)),r.ssr&&S.eachChild(function(D){var T=ce(D);T.seriesIndex=b.seriesIndex,T.dataIndex=f,T.ssrType="legend"}),d&&S.eachChild(function(D){g.packEventData(D,e,b,f,h)}),s.set(h,!0)}else r.eachRawSeries(function(D){var T=this;if(!s.get(h)&&D.legendVisualProvider){var R=D.legendVisualProvider;if(!R.containName(h))return;var z=R.indexOfName(h),G=R.getItemVisual(z,"style"),X=R.getItemVisual(z,"legendIcon"),O=_a(G.fill);O&&O[3]===0&&(O[3]=.2,G=Z(Z({},G),{fill:Da(O,"rgba")}));var H=this._createItem(D,h,f,p,e,t,{},G,X,y,o);H.on("click",le(wt,null,h,o,u)).on("mouseover",le(st,null,h,o,u)).on("mouseout",le(lt,null,h,o,u)),r.ssr&&H.eachChild(function(k){var B=ce(k);B.seriesIndex=D.seriesIndex,B.dataIndex=f,B.ssrType="legend"}),d&&H.eachChild(function(k){T.packEventData(k,e,D,f,h)}),s.set(h,!0)}},this)},this),i&&this._createSelector(i,e,o,l,c)},a.prototype.packEventData=function(t,e,r,o,i){var l={componentType:"legend",componentIndex:e.componentIndex,dataIndex:o,value:i,seriesIndex:r.seriesIndex};ce(t).eventData=l},a.prototype._createSelector=function(t,e,r,o,i){var l=this.getSelectorGroup();ot(t,function(v){var s=v.type,y=new ke({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){r.dispatchAction({type:s==="all"?"legendAllSelect":"legendInverseSelect",legendId:e.id})}});l.add(y);var d=e.getModel("selectorLabel"),u=e.getModel(["emphasis","selectorLabel"]);Ft(y,{normal:d,emphasis:u},{defaultText:v.title}),Lt(y)})},a.prototype._createItem=function(t,e,r,o,i,l,c,v,s,y,d){var u=t.visualDrawType,p=i.get("itemWidth"),f=i.get("itemHeight"),g=i.isSelected(e),h=o.get("symbolRotate"),m=o.get("symbolKeepAspect"),b=o.get("icon");s=b||s||"roundRect";var C=wr(s,o,c,v,u,g,d),x=new Ae,_=o.getModel("textStyle");if(Oe(t.getLegendIcon)&&(!b||b==="inherit"))x.add(t.getLegendIcon({itemWidth:p,itemHeight:f,icon:s,iconRotate:h,itemStyle:C.itemStyle,lineStyle:C.lineStyle,symbolKeepAspect:m}));else{var A=b==="inherit"&&t.getData().getVisual("symbol")?h==="inherit"?t.getData().getVisual("symbolRotate"):h:0;x.add(Tr({itemWidth:p,itemHeight:f,icon:s,iconRotate:A,itemStyle:C.itemStyle,symbolKeepAspect:m}))}var S=l==="left"?p+5:-5,D=l,T=i.get("formatter"),R=e;Me(T)&&T?R=T.replace("{name}",e??""):Oe(T)&&(R=T(e));var z=g?_.getTextColor():o.get("inactiveColor");x.add(new ke({style:Aa(_,{text:R,x:S,y:f/2,fill:z,align:D,verticalAlign:"middle"},{inheritColor:z})}));var G=new ct({shape:x.getBoundingRect(),style:{fill:"transparent"}}),X=o.getModel("tooltip");return X.get("show")&&wa({el:G,componentModel:i,itemName:e,itemTooltipOption:X.option}),x.add(G),x.eachChild(function(O){O.silent=!0}),G.silent=!y,this.getContentGroup().add(x),Lt(x),x.__legendDataIndex=r,x},a.prototype.layoutInner=function(t,e,r,o,i,l){var c=this.getContentGroup(),v=this.getSelectorGroup();me(t.get("orient"),c,t.get("itemGap"),r.width,r.height);var s=c.getBoundingRect(),y=[-s.x,-s.y];if(v.markRedraw(),c.markRedraw(),i){me("horizontal",v,t.get("selectorItemGap",!0));var d=v.getBoundingRect(),u=[-d.x,-d.y],p=t.get("selectorButtonGap",!0),f=t.getOrient().index,g=f===0?"width":"height",h=f===0?"height":"width",m=f===0?"y":"x";l==="end"?u[f]+=s[g]+p:y[f]+=d[g]+p,u[1-f]+=s[h]/2-d[h]/2,v.x=u[0],v.y=u[1],c.x=y[0],c.y=y[1];var b={x:0,y:0};return b[g]=s[g]+p+d[g],b[h]=Math.max(s[h],d[h]),b[m]=Math.min(0,d[m]+u[1-f]),b}else return c.x=y[0],c.y=y[1],this.group.getBoundingRect()},a.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},a.type="legend.plain",a}(Ta);function wr(n,a,t,e,r,o,i){function l(g,h){g.lineWidth==="auto"&&(g.lineWidth=h.lineWidth>0?2:0),ot(g,function(m,b){g[b]==="inherit"&&(g[b]=h[b])})}var c=a.getModel("itemStyle"),v=c.getItemStyle(),s=n.lastIndexOf("empty",0)===0?"fill":"stroke",y=c.getShallow("decal");v.decal=!y||y==="inherit"?e.decal:Pa(y,i),v.fill==="inherit"&&(v.fill=e[r]),v.stroke==="inherit"&&(v.stroke=e[s]),v.opacity==="inherit"&&(v.opacity=(r==="fill"?e:t).opacity),l(v,e);var d=a.getModel("lineStyle"),u=d.getLineStyle();if(l(u,t),v.fill==="auto"&&(v.fill=e.fill),v.stroke==="auto"&&(v.stroke=e.fill),u.stroke==="auto"&&(u.stroke=e.fill),!o){var p=a.get("inactiveBorderWidth"),f=v[s];v.lineWidth=p==="auto"?e.lineWidth>0&&f?2:0:v.lineWidth,v.fill=a.get("inactiveColor"),v.stroke=a.get("inactiveBorderColor"),u.stroke=d.get("inactiveColor"),u.lineWidth=d.get("inactiveWidth")}return{itemStyle:v,lineStyle:u}}function Tr(n){var a=n.icon||"roundRect",t=Ia(a,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return t.setStyle(n.itemStyle),t.rotation=(n.iconRotate||0)*Math.PI/180,t.setOrigin([n.itemWidth/2,n.itemHeight/2]),a.indexOf("empty")>-1&&(t.style.stroke=t.style.fill,t.style.fill=Y.color.neutral00,t.style.lineWidth=2),t}function wt(n,a,t,e){lt(n,a,t,e),t.dispatchAction({type:"legendToggleSelect",name:n??a}),st(n,a,t,e)}function qt(n){for(var a=n.getZr().storage.getDisplayList(),t,e=0,r=a.length;e<r&&!(t=a[e].states.emphasis);)e++;return t&&t.hoverLayer}function st(n,a,t,e){qt(t)||t.dispatchAction({type:"highlight",seriesName:n,name:a,excludeSeriesId:e})}function lt(n,a,t,e){qt(t)||t.dispatchAction({type:"downplay",seriesName:n,name:a,excludeSeriesId:e})}function Pr(n){var a=n.findComponents({mainType:"legend"});a&&a.length&&n.filterSeries(function(t){for(var e=0;e<a.length;e++)if(!a[e].isSelected(t.name))return!1;return!0})}function pe(n,a,t){var e=n==="allSelect"||n==="inverseSelect",r={},o=[];t.eachComponent({mainType:"legend",query:a},function(l){e?l[n]():l[n](a.name),Tt(l,r),o.push(l.componentIndex)});var i={};return t.eachComponent("legend",function(l){U(r,function(c,v){l[c?"select":"unSelect"](v)}),Tt(l,i)}),e?{selected:i,legendIndex:o}:{name:a.name,selected:i}}function Tt(n,a){var t=a||{};return U(n.getData(),function(e){var r=e.get("name");if(!(r===`
`||r==="")){var o=n.isSelected(r);Ga(t,r)?t[r]=t[r]&&o:t[r]=o}}),t}function Ir(n){n.registerAction("legendToggleSelect","legendselectchanged",J(pe,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",J(pe,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",J(pe,"inverseSelect")),n.registerAction("legendSelect","legendselected",J(pe,"select")),n.registerAction("legendUnSelect","legendunselected",J(pe,"unSelect"))}function Kt(n){n.registerComponentModel(it),n.registerComponentView($t),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,Pr),n.registerSubTypeDefaulter("legend",function(){return"plain"}),Ir(n)}var Gr=function(n){ae(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=a.type,t}return a.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},a.prototype.init=function(t,e,r){var o=Ra(t);n.prototype.init.call(this,t,e,r),Pt(this,t,o)},a.prototype.mergeOption=function(t,e){n.prototype.mergeOption.call(this,t,e),Pt(this,this.option,t)},a.type="legend.scroll",a.defaultOption=Oa(it.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:Y.color.accent50,pageIconInactiveColor:Y.color.accent10,pageIconSize:15,pageTextStyle:{color:Y.color.tertiary},animationDurationUpdate:800}),a}(it);function Pt(n,a,t){var e=n.getOrient(),r=[1,1];r[e.index]=0,Ma(a,t,{type:"box",ignoreSize:!!r})}var It=Nt,Je=["width","height"],Qe=["x","y"],Rr=function(n){ae(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=a.type,t.newlineDisabled=!0,t._currentIndex=0,t}return a.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new It),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new It)},a.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},a.prototype.renderInner=function(t,e,r,o,i,l,c){var v=this;n.prototype.renderInner.call(this,t,e,r,o,i,l,c);var s=this._controllerGroup,y=e.get("pageIconSize",!0),d=Fe(y)?y:[y,y];p("pagePrev",0);var u=e.getModel("pageTextStyle");s.add(new ke({name:"pageText",style:{text:"xx/xx",fill:u.getTextColor(),font:u.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),p("pageNext",1);function p(f,g){var h=f+"DataIndex",m=ka(e.get("pageIcons",!0)[e.getOrient().name][g],{onclick:nt(v._pageGo,v,h,e,o)},{x:-d[0]/2,y:-d[1]/2,width:d[0],height:d[1]});m.name=f,s.add(m)}},a.prototype.layoutInner=function(t,e,r,o,i,l){var c=this.getSelectorGroup(),v=t.getOrient().index,s=Je[v],y=Qe[v],d=Je[1-v],u=Qe[1-v];i&&me("horizontal",c,t.get("selectorItemGap",!0));var p=t.get("selectorButtonGap",!0),f=c.getBoundingRect(),g=[-f.x,-f.y],h=zt(r);i&&(h[s]=r[s]-f[s]-p);var m=this._layoutContentAndController(t,o,h,v,s,d,u,y);if(i){if(l==="end")g[v]+=m[s]+p;else{var b=f[s]+p;g[v]-=b,m[y]-=b}m[s]+=f[s]+p,g[1-v]+=m[u]+m[d]/2-f[d]/2,m[d]=Math.max(m[d],f[d]),m[u]=Math.min(m[u],f[u]+g[1-v]),c.x=g[0],c.y=g[1],c.markRedraw()}return m},a.prototype._layoutContentAndController=function(t,e,r,o,i,l,c,v){var s=this.getContentGroup(),y=this._containerGroup,d=this._controllerGroup;me(t.get("orient"),s,t.get("itemGap"),o?r.width:null,o?null:r.height),me("horizontal",d,t.get("pageButtonItemGap",!0));var u=s.getBoundingRect(),p=d.getBoundingRect(),f=this._showController=u[i]>r[i],g=[-u.x,-u.y];e||(g[o]=s[v]);var h=[0,0],m=[-p.x,-p.y],b=Re(t.get("pageButtonGap",!0),t.get("itemGap",!0));if(f){var C=t.get("pageButtonPosition",!0);C==="end"?m[o]+=r[i]-p[i]:h[o]+=p[i]+b}m[1-o]+=u[l]/2-p[l]/2,s.setPosition(g),y.setPosition(h),d.setPosition(m);var x={x:0,y:0};if(x[i]=f?r[i]:u[i],x[l]=Math.max(u[l],p[l]),x[c]=Math.min(0,p[c]+m[1-o]),y.__rectSize=r[i],f){var _={x:0,y:0};_[i]=Math.max(r[i]-p[i]-b,0),_[l]=x[l],y.setClipPath(new ct({shape:_})),y.__rectSize=_[i]}else d.eachChild(function(S){S.attr({invisible:!0,silent:!0})});var A=this._getPageInfo(t);return A.pageIndex!=null&&be(s,{x:A.contentPosition[0],y:A.contentPosition[1]},f?t:null),this._updatePageInfoView(t,A),x},a.prototype._pageGo=function(t,e,r){var o=this._getPageInfo(e)[t];o!=null&&r.dispatchAction({type:"legendScroll",scrollDataIndex:o,legendId:e.id})},a.prototype._updatePageInfoView=function(t,e){var r=this._controllerGroup;U(["pagePrev","pageNext"],function(s){var y=s+"DataIndex",d=e[y]!=null,u=r.childOfName(s);u&&(u.setStyle("fill",d?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),u.cursor=d?"pointer":"default")});var o=r.childOfName("pageText"),i=t.get("pageFormatter"),l=e.pageIndex,c=l!=null?l+1:0,v=e.pageCount;o&&i&&o.setStyle("text",Me(i)?i.replace("{current}",c==null?"":c+"").replace("{total}",v==null?"":v+""):i({current:c,total:v}))},a.prototype._getPageInfo=function(t){var e=t.get("scrollDataIndex",!0),r=this.getContentGroup(),o=this._containerGroup.__rectSize,i=t.getOrient().index,l=Je[i],c=Qe[i],v=this._findTargetItemIndex(e),s=r.children(),y=s[v],d=s.length,u=d?1:0,p={contentPosition:[r.x,r.y],pageCount:u,pageIndex:u-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!y)return p;var f=C(y);p.contentPosition[i]=-f.s;for(var g=v+1,h=f,m=f,b=null;g<=d;++g)b=C(s[g]),(!b&&m.e>h.s+o||b&&!x(b,h.s))&&(m.i>h.i?h=m:h=b,h&&(p.pageNextDataIndex==null&&(p.pageNextDataIndex=h.i),++p.pageCount)),m=b;for(var g=v-1,h=f,m=f,b=null;g>=-1;--g)b=C(s[g]),(!b||!x(m,b.s))&&h.i<m.i&&(m=h,p.pagePrevDataIndex==null&&(p.pagePrevDataIndex=h.i),++p.pageCount,++p.pageIndex),h=b;return p;function C(_){if(_){var A=_.getBoundingRect(),S=A[c]+_[c];return{s:S,e:S+A[l],i:_.__legendDataIndex}}}function x(_,A){return _.e>=A&&_.s<=A+o}},a.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var e,r=this.getContentGroup(),o;return r.eachChild(function(i,l){var c=i.__legendDataIndex;o==null&&c!=null&&(o=l),c===t&&(e=l)}),e??o},a.type="legend.scroll",a}($t);function Or(n){n.registerAction("legendScroll","legendscroll",function(a,t){var e=a.scrollDataIndex;e!=null&&t.eachComponent({mainType:"legend",subType:"scroll",query:a},function(r){r.setScrollDataIndex(e)})})}function Mr(n){Be(Kt),n.registerComponentModel(Gr),n.registerComponentView(Rr),Or(n)}function kr(n){Be(Kt),Be(Mr)}function we(n,a,t){var e=n.get("borderRadius");if(e==null)return t?{cornerRadius:0}:null;Fe(e)||(e=[e,e,e,e]);var r=Math.abs(a.r||0-a.r0||0);return{cornerRadius:Et(e,function(o){return Ba(o,r)})}}var Gt=Math.PI*2,Te=Math.PI/180;function Br(n,a,t){a.eachSeriesByType(n,function(e){var r=e.getData(),o=r.mapDimension("value"),i=Ea(e,t),l=i.cx,c=i.cy,v=i.r,s=i.r0,y=i.viewRect,d=-e.get("startAngle")*Te,u=e.get("endAngle"),p=e.get("padAngle")*Te;u=u==="auto"?d-Gt:-u*Te;var f=e.get("minAngle")*Te,g=f+p,h=0;r.each(o,function(k){!isNaN(k)&&h++});var m=r.getSum(o),b=Math.PI/(m||h)*2,C=e.get("clockwise"),x=e.get("roseType"),_=e.get("stillShowZeroSum"),A=r.getDataExtent(o);A[0]=0;var S=C?1:-1,D=[d,u],T=S*p/2;Na(D,!C),d=D[0],u=D[1];var R=Zt(e);R.startAngle=d,R.endAngle=u,R.clockwise=C,R.cx=l,R.cy=c,R.r=v,R.r0=s;var z=Math.abs(u-d),G=z,X=0,O=d;if(r.setLayout({viewRect:y,r:v}),r.each(o,function(k,B){var P;if(isNaN(k)){r.setItemLayout(B,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:C,cx:l,cy:c,r0:s,r:x?NaN:v});return}x!=="area"?P=m===0&&_?b:k*b:P=z/h,P<g?(P=g,G-=g):X+=k;var F=O+S*P,E=0,M=0;p>P?(E=O+S*P/2,M=E):(E=O+T,M=F-T),r.setItemLayout(B,{angle:P,startAngle:E,endAngle:M,clockwise:C,cx:l,cy:c,r0:s,r:x?Fa(k,A,[s,v]):v}),O=F}),G<Gt&&h)if(G<=.001){var H=z/h;r.each(o,function(k,B){if(!isNaN(k)){var P=r.getItemLayout(B);P.angle=H;var F=0,E=0;H<p?(F=d+S*(B+1/2)*H,E=F):(F=d+S*B*H+T,E=d+S*(B+1)*H-T),P.startAngle=F,P.endAngle=E}})}else b=G/X,O=d,r.each(o,function(k,B){if(!isNaN(k)){var P=r.getItemLayout(B),F=P.angle===g?g:k*b,E=0,M=0;F<p?(E=O+S*F/2,M=E):(E=O+T,M=O+S*F-T),P.startAngle=E,P.endAngle=M,O+=S*F}})})}var Zt=xe();function Er(n){return{seriesType:n,reset:function(a,t){var e=t.findComponents({mainType:"legend"});if(!(!e||!e.length)){var r=a.getData();r.filterSelf(function(o){for(var i=r.getName(o),l=0;l<e.length;l++)if(!e[l].isSelected(i))return!1;return!0})}}}}var Nr=Math.PI/180;function Rt(n,a,t,e,r,o,i,l,c,v){if(n.length<2)return;function s(f){for(var g=f.rB,h=g*g,m=0;m<f.list.length;m++){var b=f.list[m],C=Math.abs(b.label.y-t),x=e+b.len,_=x*x,A=Math.sqrt(Math.abs((1-C*C/h)*_)),S=a+(A+b.len2)*r,D=S-b.label.x,T=b.targetTextWidth-D*r;Jt(b,T,!0),b.label.x=S}}function y(f){for(var g={list:[],maxY:0},h={list:[],maxY:0},m=0;m<f.length;m++)if(f[m].labelAlignTo==="none"){var b=f[m],C=b.label.y>t?h:g,x=Math.abs(b.label.y-t);if(x>=C.maxY){var _=b.label.x-a-b.len2*r,A=e+b.len,S=Math.abs(_)<A?Math.sqrt(x*x/(1-_*_/A/A)):A;C.rB=S,C.maxY=x}C.list.push(b)}s(g),s(h)}for(var d=n.length,u=0;u<d;u++)if(n[u].position==="outer"&&n[u].labelAlignTo==="labelLine"){var p=n[u].label.x-v;n[u].linePoints[1][0]+=p,n[u].label.x=v}at(n,1,c,c+i)&&y(n)}function Fr(n,a,t,e,r,o,i,l){for(var c=[],v=[],s=Number.MAX_VALUE,y=-Number.MAX_VALUE,d=0;d<n.length;d++){var u=n[d].label;et(n[d])||(u.x<a?(s=Math.min(s,u.x),c.push(n[d])):(y=Math.max(y,u.x),v.push(n[d])))}for(var d=0;d<n.length;d++){var p=n[d];if(!et(p)&&p.linePoints){if(p.labelStyleWidth!=null)continue;var u=p.label,f=p.linePoints,g=void 0;p.labelAlignTo==="edge"?u.x<a?g=f[2][0]-p.labelDistance-i-p.edgeDistance:g=i+r-p.edgeDistance-f[2][0]-p.labelDistance:p.labelAlignTo==="labelLine"?u.x<a?g=s-i-p.bleedMargin:g=i+r-y-p.bleedMargin:u.x<a?g=u.x-i-p.bleedMargin:g=i+r-u.x-p.bleedMargin,p.targetTextWidth=g,Jt(p,g,!1)}}Rt(v,a,t,e,1,r,o,i,l,y),Rt(c,a,t,e,-1,r,o,i,l,s);for(var d=0;d<n.length;d++){var p=n[d];if(!et(p)&&p.linePoints){var u=p.label,f=p.linePoints,h=p.labelAlignTo==="edge",m=u.style.padding,b=m?m[1]+m[3]:0,C=u.style.backgroundColor?0:b,x=p.rect.width+C,_=f[1][0]-f[2][0];h?u.x<a?f[2][0]=i+p.edgeDistance+x+p.labelDistance:f[2][0]=i+r-p.edgeDistance-x-p.labelDistance:(u.x<a?f[2][0]=u.x+p.labelDistance:f[2][0]=u.x-p.labelDistance,f[1][0]=f[2][0]+_),f[1][1]=f[2][1]=u.y}}}function Jt(n,a,t){if(n.labelStyleWidth==null){var e=n.label,r=e.style,o=n.rect,i=r.backgroundColor,l=r.padding,c=l?l[1]+l[3]:0,v=r.overflow,s=o.width+(i?0:c);if(a<s||t){if(v&&v.match("break")){e.setStyle("backgroundColor",null),e.setStyle("width",a-c);var y=e.getBoundingRect();e.setStyle("width",Math.ceil(y.width)),e.setStyle("backgroundColor",i)}else{var d=a-c,u=a<s?d:t?d>n.unconstrainedWidth?null:d:null;e.setStyle("width",u)}Qt(o,e)}}}function Qt(n,a){Ot.rect=n,za(Ot,a,zr)}var zr={minMarginForce:[null,0,null,0],marginDefault:[1,0,1,0]},Ot={};function et(n){return n.position==="center"}function Vr(n){var a=n.getData(),t=[],e,r,o=!1,i=(n.get("minShowLabelAngle")||0)*Nr,l=a.getLayout("viewRect"),c=a.getLayout("r"),v=l.width,s=l.x,y=l.y,d=l.height;function u(_){_.ignore=!0}function p(_){if(!_.ignore)return!0;for(var A in _.states)if(_.states[A].ignore===!1)return!0;return!1}a.each(function(_){var A=a.getItemGraphicEl(_),S=A.shape,D=A.getTextContent(),T=A.getTextGuideLine(),R=a.getItemModel(_),z=R.getModel("label"),G=z.get("position")||R.get(["emphasis","label","position"]),X=z.get("distanceToLabelLine"),O=z.get("alignTo"),H=he(z.get("edgeDistance"),v),k=z.get("bleedMargin");k==null&&(k=Math.min(v,d)>200?10:2);var B=R.getModel("labelLine"),P=B.get("length");P=he(P,v);var F=B.get("length2");if(F=he(F,v),Math.abs(S.endAngle-S.startAngle)<i){U(D.states,u),D.ignore=!0,T&&(U(T.states,u),T.ignore=!0);return}if(p(D)){var E=(S.startAngle+S.endAngle)/2,M=Math.cos(E),Q=Math.sin(E),ue,Se,vt,Le;e=S.cx,r=S.cy;var re=G==="inside"||G==="inner";if(G==="center")ue=S.cx,Se=S.cy,Le="center";else{var ze=(re?(S.r+S.r0)/2*M:S.r*M)+e,Ve=(re?(S.r+S.r0)/2*Q:S.r*Q)+r;if(ue=ze+M*3,Se=Ve+Q*3,!re){var gt=ze+M*(P+c-S.r),ft=Ve+Q*(P+c-S.r),pt=gt+(M<0?-1:1)*F,dt=ft;O==="edge"?ue=M<0?s+H:s+v-H:ue=pt+(M<0?-X:X),Se=dt,vt=[[ze,Ve],[gt,ft],[pt,dt]]}Le=re?"center":O==="edge"?M>0?"right":"left":M>0?"left":"right"}var ve=Math.PI,ne=0,ge=z.get("rotate");if(ut(ge))ne=ge*(ve/180);else if(G==="center")ne=0;else if(ge==="radial"||ge===!0){var ta=M<0?-E+ve:-E;ne=ta}else if(ge==="tangential"&&G!=="outside"&&G!=="outer"){var ie=Math.atan2(M,Q);ie<0&&(ie=ve*2+ie);var aa=Q>0;aa&&(ie=ve+ie),ne=ie-ve}if(o=!!ne,D.x=ue,D.y=Se,D.rotation=ne,D.setStyle({verticalAlign:"middle"}),re){D.setStyle({align:Le});var Ye=D.states.select;Ye&&(Ye.x+=D.x,Ye.y+=D.y)}else{var We=new tt(0,0,0,0);Qt(We,D),t.push({label:D,labelLine:T,position:G,len:P,len2:F,minTurnAngle:B.get("minTurnAngle"),maxSurfaceAngle:B.get("maxSurfaceAngle"),surfaceNormal:new N(M,Q),linePoints:vt,textAlign:Le,labelDistance:X,labelAlignTo:O,edgeDistance:H,bleedMargin:k,rect:We,unconstrainedWidth:We.width,labelStyleWidth:D.style.width})}A.setTextConfig({inside:re})}}),!o&&n.get("avoidLabelOverlap")&&Fr(t,e,r,c,v,d,s,y);for(var f=0;f<t.length;f++){var g=t[f],h=g.label,m=g.labelLine,b=isNaN(h.x)||isNaN(h.y);if(h){h.setStyle({align:g.textAlign}),b&&(U(h.states,u),h.ignore=!0);var C=h.states.select;C&&(C.x+=h.x,C.y+=h.y)}if(m){var x=g.linePoints;b||!x?(U(m.states,u),m.ignore=!0):(Ht(x,g.minTurnAngle),mr(x,g.surfaceNormal,g.maxSurfaceAngle),m.setShape({points:x}),h.__hostTarget.textGuideLineConfig={anchor:new N(x[0][0],x[0][1])})}}}var Wr=function(n){ae(a,n);function a(t,e,r){var o=n.call(this)||this;o.z2=2;var i=new ke;return o.setTextContent(i),o.updateData(t,e,r,!0),o}return a.prototype.updateData=function(t,e,r,o){var i=this,l=t.hostModel,c=t.getItemModel(e),v=c.getModel("emphasis"),s=t.getItemLayout(e),y=Z(we(c.getModel("itemStyle"),s,!0),s);if(isNaN(y.startAngle)){i.setShape(y);return}if(o){i.setShape(y);var d=l.getShallow("animationType");l.ecModel.ssr?(ye(i,{scaleX:0,scaleY:0},l,{dataIndex:e,isFrom:!0}),i.originX=y.cx,i.originY=y.cy):d==="scale"?(i.shape.r=s.r0,ye(i,{shape:{r:s.r}},l,e)):r!=null?(i.setShape({startAngle:r,endAngle:r}),ye(i,{shape:{startAngle:s.startAngle,endAngle:s.endAngle}},l,e)):(i.shape.endAngle=s.startAngle,be(i,{shape:{endAngle:s.endAngle}},l,e))}else Ya(i),be(i,{shape:y},l,e);i.useStyle(t.getItemVisual(e,"style")),Ua(i,c);var u=(s.startAngle+s.endAngle)/2,p=l.get("selectedOffset"),f=Math.cos(u)*p,g=Math.sin(u)*p,h=c.getShallow("cursor");h&&i.attr("cursor",h),this._updateLabel(l,t,e),i.ensureState("emphasis").shape=Z({r:s.r+(v.get("scale")&&v.get("scaleSize")||0)},we(v.getModel("itemStyle"),s)),Z(i.ensureState("select"),{x:f,y:g,shape:we(c.getModel(["select","itemStyle"]),s)}),Z(i.ensureState("blur"),{shape:we(c.getModel(["blur","itemStyle"]),s)});var m=i.getTextGuideLine(),b=i.getTextContent();m&&Z(m.ensureState("select"),{x:f,y:g}),Z(b.ensureState("select"),{x:f,y:g}),Ha(this,v.get("focus"),v.get("blurScope"),v.get("disabled"))},a.prototype._updateLabel=function(t,e,r){var o=this,i=e.getItemModel(r),l=i.getModel("labelLine"),c=e.getItemVisual(r,"style"),v=c&&c.fill,s=c&&c.opacity;Ft(o,Xa(i),{labelFetcher:e.hostModel,labelDataIndex:r,inheritColor:v,defaultOpacity:s,defaultText:t.getFormattedLabel(r,"normal")||e.getName(r)});var y=o.getTextContent();o.setTextConfig({position:null,rotation:null}),y.attr({z2:10});var d=i.get(["label","position"]);if(d!=="outside"&&d!=="outer")o.removeTextGuideLine();else{var u=this.getTextGuideLine();u||(u=new Mt,this.setTextGuideLine(u)),Xt(this,jt(i),{stroke:v,opacity:ja(l.get(["lineStyle","opacity"]),s,1)})}},a}(Vt),Yr=function(n){ae(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return a.prototype.render=function(t,e,r,o){var i=t.getData(),l=this._data,c=this.group,v;if(!l&&i.count()>0){for(var s=i.getItemLayout(0),y=1;isNaN(s&&s.startAngle)&&y<i.count();++y)s=i.getItemLayout(y);s&&(v=s.startAngle)}if(this._emptyCircleSector&&c.remove(this._emptyCircleSector),i.count()===0&&t.get("showEmptyCircle")){var d=Zt(t),u=new Vt({shape:zt(d)});u.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=u,c.add(u)}i.diff(l).add(function(p){var f=new Wr(i,p,v);i.setItemGraphicEl(p,f),c.add(f)}).update(function(p,f){var g=l.getItemGraphicEl(f);g.updateData(i,p,v),g.off("click"),c.add(g),i.setItemGraphicEl(p,g)}).remove(function(p){var f=l.getItemGraphicEl(p);Va(f,t,p)}).execute(),Vr(t),t.get("animationTypeUpdate")!=="expansion"&&(this._data=i)},a.prototype.dispose=function(){},a.prototype.containPoint=function(t,e){var r=e.getData(),o=r.getItemLayout(0);if(o){var i=t[0]-o.cx,l=t[1]-o.cy,c=Math.sqrt(i*i+l*l);return c<=o.r&&c>=o.r0}},a.type="pie",a}(Wa);function Ur(n,a,t){a=Fe(a)&&{coordDimensions:a}||Z({encodeDefine:n.getEncode()},a);var e=n.getSource(),r=$a(e,a).dimensions,o=new qa(r,n);return o.initData(e,t),o}var Hr=function(){function n(a,t){this._getDataWithEncodedVisual=a,this._getRawData=t}return n.prototype.getAllNames=function(){var a=this._getRawData();return a.mapArray(a.getName)},n.prototype.containName=function(a){var t=this._getRawData();return t.indexOfName(a)>=0},n.prototype.indexOfName=function(a){var t=this._getDataWithEncodedVisual();return t.indexOfName(a)},n.prototype.getItemVisual=function(a,t){var e=this._getDataWithEncodedVisual();return e.getItemVisual(a,t)},n}(),Xr=xe(),ea=function(n){ae(a,n);function a(){return n!==null&&n.apply(this,arguments)||this}return a.prototype.init=function(t){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new Hr(nt(this.getData,this),nt(this.getRawData,this)),this._defaultLabelLine(t)},a.prototype.mergeOption=function(){n.prototype.mergeOption.apply(this,arguments)},a.prototype.getInitialData=function(){return Ur(this,{coordDimensions:["value"],encodeDefaulter:J(Qa,this)})},a.prototype.getDataParams=function(t){var e=this.getData(),r=Xr(e),o=r.seats;if(!o){var i=[];e.each(e.mapDimension("value"),function(c){i.push(c)}),o=r.seats=Ka(i,e.hostModel.get("percentPrecision"))}var l=n.prototype.getDataParams.call(this,t);return l.percent=o[t]||0,l.$vars.push("percent"),l},a.prototype._defaultLabelLine=function(t){Za(t,"labelLine",["show"]);var e=t.labelLine,r=t.emphasis.labelLine;e.show=e.show&&t.label.show,r.show=r.show&&t.emphasis.label.show},a.type="series.pie",a.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"50%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,coordinateSystemUsage:"box",left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:30,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},a}(Ja);er({fullType:ea.type,getCoord2:function(n){return n.getShallow("center")}});function jr(n){return{seriesType:n,reset:function(a,t){var e=a.getData();e.filterSelf(function(r){var o=e.mapDimension("value"),i=e.get(o,r);return!(ut(i)&&!isNaN(i)&&i<0)})}}}function $r(n){n.registerChartView(Yr),n.registerSeriesModel(ea),tr("pie",n.registerAction),n.registerLayout(J(Br,"pie")),n.registerProcessor(Er("pie")),n.registerProcessor(jr("pie"))}const qr=Wt({__name:"PieChart",props:{dataMap:{},pieName:{},color:{}},setup(n){Be([ar,$r,kr,rr,_r,nr]);const a=te(),t=n;let e;je(a,l=>{if(l){e=ir(l);const c={tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},color:t.color||void 0,series:[{name:t.pieName,type:"pie",radius:"50%",data:t.dataMap.map(v=>({name:v.tag,value:v.value})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};c&&e.setOption(c)}}),je(()=>t.dataMap,l=>{e.setOption({series:[{name:t.pieName,type:"pie",radius:"50%",data:l.map(c=>({name:c.tag,value:c.value})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})},{deep:!0});const r=te();let o,i=0;return je(r,l=>{l?(o=new ResizeObserver(()=>{clearTimeout(i),i=setTimeout(()=>{e&&e.resize()},300)}),o.observe(l)):(o?.disconnect(),o=void 0)}),(l,c)=>(Ge(),Ie("div",{ref_key:"containerRef",ref:r,class:"container"},[c[0]||(c[0]=L("div",{class:"backgound"},null,-1)),L("div",{ref_key:"echartRef",ref:a,class:"payload"},null,512)],512))}}),Kr=Yt(qr,[["__scopeId","data-v-bbe4a85e"]]),Zr=["#60A5FA","#5294F7","#4483F4","#3672F1","#2861EE","#1E3A8A"],Jr=["#6EE7B7","#5DDDB0","#4CCE99","#3BBF82","#2AB06B","#065F46"],Qr=["#FBBF24","#F4AA1E","#EE9518","#E78012","#E06B0C","#C2410C"],en=["#6EE7F5","#5CDAEA","#4BCBDF","#3ABDD4","#29AEC9","#065F46"],tn=["#A5B4FC","#94A3F9","#8392F6","#7281F3","#6170F0","#4C1D95"],an=["#F87171","#E76363","#D65555","#C54747","#B43939","#7F1D1D"],rn=[Zr,Jr,Qr,en,tn,an],nn={class:"layout"},on={class:"static-row flex"},sn={class:"static-card flex"},ln={class:"left flex"},cn={class:"label-show"},un={class:"number"},vn={class:"ud-decoration"},gn={class:"row-title flex"},fn={class:"right"},pn={class:"static-row flex"},dn={class:"static-card"},hn={class:"left flex"},yn={class:"label-show"},mn={class:"number"},bn={class:"ud-decoration"},xn={class:"static-card"},Sn={class:"left flex"},Ln={class:"label-show"},Cn={class:"number"},_n={class:"ud-decoration"},Dn={class:"static-area"},An={class:"static"},wn={class:"title"},Tn={class:"static-title"},Pn={class:"chart-area"},In=Wt({__name:"Statics",setup(n){const a=te([]);async function t(){const f=await vr("/api/data/category-count",{method:"GET"});return f&&f.data&&f.data.success?f.data.data:[]}const{StreetMap:e,CommunityMap:r}=gr();async function o(f,g){return f==="street"?g.map(h=>({tag:e[h.tag].name,value:h.value})):f==="community"?g.map(h=>({tag:r[h.tag].name,value:h.value})):f==="warningStatus"?g.map(h=>({tag:yt.warningStatus[Number(h.tag)],value:h.value})):f==="gender"?g.map(h=>({tag:yt.gender[Number(h.tag)],value:h.value})):g}const i=te([]);Ct(async()=>{const f=await t();Ue(oe).forEach(async(g,h)=>{const m=oe[g];i.value[h]={title:m,categoryCount:f[h]?await o(g,f[h]):[]}})});async function l(){a.value=await ra()}l();const c={street:"icon-location",community:"icon-home",warningStatus:"icon-warning",age:"icon-person",gender:"icon-gender",tempProtect:"icon-shield"},v=Ue(oe).reduce((f,g)=>{const h=oe[g];return f[h]=c[g],f},Object.create(null));function s(f){return v[f.title]}const y=te(Date.now()),d=te(0),u=te(0);Ct(async()=>{const f=na(new Date(y.value));d.value=await ht("in",f),u.value=await ht("out",f)});const p=f=>{const g=Ue(oe).findIndex(h=>oe[h]===f.title);if(g!==-1)return rn[g]};return(f,g)=>{const h=or("ElDatePicker");return Ge(),Ie("div",nn,[g[14]||(g[14]=L("div",{class:"row-title"},[L("span",{class:"icon icon-free icon-bold icon-pie"}),se(" 累计数据概览 ")],-1)),L("div",on,[L("div",sn,[L("div",ln,[g[3]||(g[3]=L("div",{class:"icon-wrap"},[L("i",{class:"icon icon-free icon-bold icon-user"})],-1)),L("div",cn,[g[2]||(g[2]=L("span",{class:"label"},"参与者总数",-1)),L("span",un,[L("span",vn,Ce($e(He)(a.value.length)),1),g[1]||(g[1]=se(" 人 ",-1))])])]),g[4]||(g[4]=L("div",{class:"right"},null,-1))])]),L("div",gn,[g[5]||(g[5]=L("div",{class:"left"},[L("span",{class:"icon icon-free icon-bold icon-calendar"}),se(" 月度数据统计 ")],-1)),L("div",fn,[_t(h,{type:"month",modelValue:y.value,"onUpdate:modelValue":g[0]||(g[0]=m=>y.value=m),placeholder:"选择一个月份"},null,8,["modelValue"])])]),L("div",pn,[L("div",dn,[L("div",hn,[g[8]||(g[8]=L("div",{class:"icon-wrap"},[L("i",{class:"icon icon-free icon-bold icon-plus"})],-1)),L("div",yn,[g[7]||(g[7]=L("span",{class:"label"},"本月录入数据",-1)),L("span",mn,[L("span",bn,Ce($e(He)(d.value)),1),g[6]||(g[6]=se(" 人 ",-1))])])]),g[9]||(g[9]=L("div",{class:"right"},null,-1))]),L("div",xn,[L("div",Sn,[g[12]||(g[12]=L("div",{class:"icon-wrap"},[L("i",{class:"icon icon-free icon-bold icon-del"})],-1)),L("div",Ln,[g[11]||(g[11]=L("span",{class:"label"},"本月删除数据",-1)),L("span",Cn,[L("span",_n,Ce($e(He)(u.value)),1),g[10]||(g[10]=se(" 人 ",-1))])])]),g[13]||(g[13]=L("div",{class:"right"},null,-1))])]),g[15]||(g[15]=L("div",{class:"row-title"},[L("span",{class:"icon icon-free icon-bold icon-static"}),se(" 数据分布图 ")],-1)),L("div",Dn,[(Ge(!0),Ie(sr,null,lr(i.value,m=>(Ge(),Ie("div",An,[L("span",wn,[L("span",{class:ur(["icon icon-free icon-bold",s(m)]),style:cr(`color: ${p(m)?.[3]}`)},null,6),L("span",Tn,Ce(m.title),1)]),L("div",Pn,[_t(Kr,{color:p(m),"data-map":m.categoryCount,"pie-name":m.title},null,8,["color","data-map","pie-name"])])]))),256))])])}}}),En=Yt(In,[["__scopeId","data-v-082d8f84"]]);export{En as default};
