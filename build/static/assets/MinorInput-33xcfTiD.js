import{a as X,M as oe}from"./minors-DzstKTHx.js";import{g as ue,r as N}from"./minors-mXhleVk2.js";import{u as re}from"./street-Dw46nwSk.js";import{P as se,d as ae,m as ie,u as de,c as F,r as x,w as H,s as g,b as E,i as m,e as n,f as A,g as s,F as U,H as Q,y,C as f,t as Y,E as me,K,I,Q as C,R as Z,S as J,U as pe,V as ce,W as ve,X as fe,Y as ye,Z as _e}from"./index-BR5oj7Uf.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as ee}from"./MultiFileInput-DNs63xtC.js";async function ge(){const o=await se("/api/data/get-areas",{method:"GET"});if(o&&o.status===200&&o.data){const{data:S}=o.data;return S}else return[]}const Ve={class:"multiple-textarea"},xe={class:"operators"},Ee={class:"section"},Me={class:"section"},ke={class:"input-mode-btns"},be={key:1,class:"show-area"},we=ae({__name:"MultipleTextarea",props:ie({inputMode:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const S=o,u=de(o,"modelValue"),t=F(()=>!!S.inputMode),v=x("");H(u,(d,a)=>{(!a||Array.isArray(a)&&!a.length)&&Array.isArray(d)&&d.length&&(v.value=d[0].key)},{immediate:!0});const V=F({get(){if(!u.value||!Array.isArray(u.value))return"";const d=u.value.find(a=>a.key===v.value);return d?d.text:""},set(d){if(!u.value||!Array.isArray(u.value))return;const a=u.value.find(_=>_.key===v.value);if(a)a.text=d;else return}}),i=x([]);async function h(){i.value=await ge()}const c=x({key:"",text:""}),k=x(),M=x(!1),P=()=>{M.value=!0,i.value.length||h()},R=()=>{M.value=!1,k.value?.clearValidate()},B=()=>{c.value.key="",c.value.text="",R()},W=()=>{P()},z=()=>{k.value&&k.value.validate(d=>{d?(Array.isArray(u.value)||(u.value=[]),u.value.push({key:c.value.key,text:c.value.text}),R(),v.value=c.value.key):me({message:"请修正填写错误项后再提交~",type:"warning"})})},G=()=>{if(!Array.isArray(u.value))return;const d=u.value.findIndex(a=>a.key===v.value);d!==-1&&(u.value.splice(d,1),v.value=u.value.length?u.value[0].key:"")},$={key:[{trigger:"blur",validator:(d,a,_)=>{u.value?.findIndex(b=>b.key===a)!==-1?_(new Error("当前索引已经被使用，请换一个不重复的索引")):_()}},{trigger:"change",require:!0,message:"索引不能为空"}]};return(d,a)=>{const _=g("ElOption"),b=g("ElSelect"),O=g("ElFormItem"),T=g("ElInput"),j=g("ElForm"),w=g("ElButton"),L=g("ElDialog");return m(),E("div",Ve,[n(L,{"append-to-body":"",modelValue:M.value,"onUpdate:modelValue":a[2]||(a[2]=r=>M.value=r),title:"新增记录",width:"500","close-on-click-modal":!1},{footer:s(()=>[A("div",xe,[n(w,{onClick:B},{default:s(()=>a[5]||(a[5]=[f("取消添加",-1)])),_:1,__:[5]}),n(w,{type:"success",onClick:z},{default:s(()=>a[6]||(a[6]=[f("确认添加",-1)])),_:1,__:[6]})])]),default:s(()=>[n(j,{ref_key:"addFormRef",ref:k,model:c.value,"label-width":"auto",rules:$},{default:s(()=>[n(O,{label:"领域",prop:"key"},{default:s(()=>[n(b,{modelValue:c.value.key,"onUpdate:modelValue":a[0]||(a[0]=r=>c.value.key=r)},{default:s(()=>[(m(!0),E(U,null,Q(i.value,r=>(m(),y(_,{key:r.id,value:r.name,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(O,{label:"内容",prop:"text"},{default:s(()=>[n(T,{type:"textarea",autosize:{minRows:2,maxRows:6},resize:"none",placeholder:"在这里编辑关注内容",modelValue:c.value.text,"onUpdate:modelValue":a[1]||(a[1]=r=>c.value.text=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),A("div",Ee,[n(b,{modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=r=>v.value=r),placeholder:"请选择一条记录..."},{default:s(()=>[(m(!0),E(U,null,Q(u.value,r=>(m(),y(_,{key:r.key,value:r.key},{default:s(()=>[f(Y(r.key),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),A("div",Me,[t.value?(m(),E(U,{key:0},[n(T,{class:"text-editor",type:"textarea",placeholder:"在这里编辑关注内容",autosize:{minRows:2,maxRows:6},resize:"both",modelValue:V.value,"onUpdate:modelValue":a[4]||(a[4]=r=>V.value=r)},null,8,["modelValue"]),A("div",ke,[n(w,{onClick:W},{default:s(()=>a[7]||(a[7]=[f("新增记录",-1)])),_:1,__:[7]}),n(w,{onClick:G},{default:s(()=>a[8]||(a[8]=[f("删除记录",-1)])),_:1,__:[8]})])],64)):(m(),E("div",be,Y(V.value),1))])])}}}),te=ne(we,[["__scopeId","data-v-8d812ca9"]]);function ze(o){return["street","community"].includes(o)}function Ie(o){return o==="tempProtect"}function Ce(o){return o==="street"}function Ae(o){return o==="community"}function Se(o){return o==="warningStatus"}function Fe(o){return o==="registratedWuhou"}function Ue(o){return o==="gender"||o==="guardianGender"}const Re={key:0,class:"operators"},Be={class:"railway"},Oe={class:"minor-input"};function le(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!_e(o)}const Te=ae({__name:"MinorInput",props:{inputMode:{type:Boolean},form:{}},emits:["submit","view-psy-test","update:form","download"],setup(o,{emit:S}){const u=o,t=x(u.form||ue()),v=x(t.value),V=S;H(t,e=>{V("update:form",e)},{deep:!0});const i=x(!!u.inputMode);H(i,e=>{e&&(v.value=Z(t.value))});const h=F(()=>i.value?X.filter(e=>e.editor!=="complex"&&e.key!=="age"&&e.key!=="guardianAge"):X.slice());function c(){V("submit",t.value),i.value=!1}function k(){V("view-psy-test")}function M(){t.value=Z(v.value)}function P(){i.value=!0}function R(){M(),i.value=!1}const{StreetMap:B,CommunityMap:W,getNameByCommunityId:z,getNameByStreetId:G,streets:$}=re(),d=e=>Ie(e)?t.value[e]?"是":"否":Ce(e)?G(t.value[e]):Ae(e)?z(t.value[e]):Se(e)?N.warningStatus[t.value[e]]:Fe(e)?N.registratedWuhou[t.value[e]]:Ue(e)?N.gender[t.value[e]]:t.value[e],a=F(()=>t.value.street&&B[t.value.street]?B[t.value.street].communities.map(e=>W[e]):[]),_=F(()=>$),b=e=>e==="street"?_.value:a.value,O=e=>e.getTime()>Date.now(),T={input:e=>n(J,{modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),date:e=>n(ye,{modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l,disabledDate:O},null),select:e=>{let l;return n(fe,{modelValue:t.value[e],"onUpdate:modelValue":p=>t.value[e]=p},le(l=b(e).map(p=>n(ve,{key:p.id,value:p.id,label:p.name},null)))?l:{default:()=>[l]})},radio:e=>{let l;return n(ce,{modelValue:t.value[e],"onUpdate:modelValue":p=>t.value[e]=p},le(l=N[e].map((p,q)=>n(pe,{value:q,label:p},null)))?l:{default:()=>[l]})},textarea:e=>n(J,{type:"textarea",modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),textareas:e=>n(te,{inputMode:i.value,modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),file:e=>n(ee,{inputMode:i.value,files:t.value[e],"onUpdate:files":l=>t.value[e]=l},null),complex:()=>{}},j={input:e=>n("span",null,[t.value[e]]),select:e=>n("span",null,[d(e)]),date:e=>n("span",null,[t.value[e]]),radio:e=>n("span",null,[d(e)]),textarea:e=>n("div",{class:"text-info"},[t.value[e]]),textareas:e=>n(te,{inputMode:i.value,modelValue:t.value[e],"onUpdate:modelValue":l=>t.value[e]=l},null),file:e=>n(ee,{"has-download":!0,inputMode:i.value,files:t.value[e],"onUpdate:files":l=>t.value[e]=l},null),complex:()=>n(C,{onClick:k},{default:()=>[f("查看详情")]})},w=({"minor-item":e})=>{const{key:l,editor:p}=e||{};return l&&p?T[p](l):null},L=({"minor-item":e})=>{const{key:l,editor:p}=e||{};return l&&p?j[p](l):null},r=()=>{V("download")};return(e,l)=>{const p=g("ElFormItem"),q=g("ElForm");return m(),E(U,null,[u.inputMode?K("",!0):(m(),E("div",Re,[A("div",Be,[i.value?(m(),y(I(C),{key:0,onClick:R,class:"btn"},{default:s(()=>l[0]||(l[0]=[f("放弃",-1)])),_:1,__:[0]})):(m(),y(I(C),{key:1,onClick:P,type:"primary",class:"btn"},{default:s(()=>l[1]||(l[1]=[f("编辑",-1)])),_:1,__:[1]})),i.value?(m(),y(I(C),{key:2,type:"warning",onClick:M,class:"btn"},{default:s(()=>l[2]||(l[2]=[f("重置",-1)])),_:1,__:[2]})):K("",!0),i.value?(m(),y(I(C),{key:3,type:"primary",onClick:c,class:"btn"},{default:s(()=>l[3]||(l[3]=[f("保存",-1)])),_:1,__:[3]})):K("",!0),i.value?K("",!0):(m(),y(I(C),{key:4,onClick:r,class:"btn"},{default:s(()=>l[4]||(l[4]=[f("下载",-1)])),_:1,__:[4]}))])])),A("div",Oe,[n(q,{class:"content",model:t.value,"label-width":"auto"},{default:s(()=>[(m(!0),E(U,null,Q(h.value,D=>(m(),y(p,{key:D.key,label:I(oe)[D.key]},{default:s(()=>[i.value?(m(),y(w,{key:0,"minor-item":D},null,8,["minor-item"])):(m(),y(L,{key:1,"minor-item":D},null,8,["minor-item"]))]),_:2},1032,["label"]))),128))]),_:1},8,["model"])])],64)}}}),Ge=ne(Te,[["__scopeId","data-v-0d619df3"]]);export{Ge as M,Se as a,ze as i};
