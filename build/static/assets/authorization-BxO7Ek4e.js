import{d as I,c as E,l as K,r as m,b as P,f as _,y as g,t as A,g as s,z as b,s as c,F as N,e as a,A as C,i as d,B as k,C as F,k as S,D as U,E as B,G as D}from"./index-BR5oj7Uf.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"title"},q={class:"btns"},G=I({__name:"authorization",setup(L){const f=S(),x=K(),l=E(()=>!x.query.modify_password),R=E(()=>l.value?"登入系统":"修改密码"),u=m({password:""}),t=m({newPassword:"",oldPassword:""}),i=m(),V=async()=>{i.value&&await i.value.validate(async p=>{if(!p)return;const{success:e,message:o}=await U(u.value);e?(await f.push("/"),i.value?.resetFields()):B({message:o,type:"error"})})},r=m(),w=async()=>{r.value&&await r.value.validate(async p=>{if(!p)return;const{success:e,message:o}=await D(t.value);e?(await f.back(),r.value?.resetFields()):B({message:o,type:"error"})})},h=async()=>{await f.back(),r.value?.resetFields()};return(p,e)=>{const o=c("ElInput"),v=c("ElFormItem"),z=c("ElForm"),y=c("ElButton");return d(),P("div",{class:C(["authorization-page",{modify:!l.value}])},[_("div",{class:C(["login-box",{modify:!l.value}])},[_("h4",T,A(R.value),1),l.value?(d(),g(z,{key:0,ref_key:"formRef",ref:i,class:"form",model:u.value,"label-width":"auto",onSubmit:e[1]||(e[1]=b(()=>{},["prevent"]))},{default:s(()=>[a(v,{label:"",prop:"password"},{default:s(()=>[a(o,{size:"large",type:"password",placeholder:"密码","show-password":"",modelValue:u.value.password,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value.password=n),onKeyup:k(V,["enter"])},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):(d(),g(z,{key:1,ref_key:"setFormRef",ref:r,class:"form",model:t.value,"label-width":"auto",onSubmit:e[4]||(e[4]=b(()=>{},["prevent"]))},{default:s(()=>[a(v,{label:"",prop:"oldPassword"},{default:s(()=>[a(o,{size:"large",type:"password",placeholder:"旧密码","show-password":"",modelValue:t.value.oldPassword,"onUpdate:modelValue":e[2]||(e[2]=n=>t.value.oldPassword=n),onKeyup:k(w,["enter"])},null,8,["modelValue"])]),_:1}),a(v,{label:"",prop:"newPassword"},{default:s(()=>[a(o,{size:"large",type:"password",placeholder:"新密码","show-password":"",modelValue:t.value.newPassword,"onUpdate:modelValue":e[3]||(e[3]=n=>t.value.newPassword=n),onKeyup:k(w,["enter"])},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),_("div",q,[l.value?(d(),g(y,{key:0,size:"large",class:"login-btn",plain:"",onClick:b(V,["prevent"])},{default:s(()=>e[5]||(e[5]=[F("进入系统",-1)])),_:1,__:[5]})):(d(),P(N,{key:1},[a(y,{size:"large",class:"confirm-btn",type:"primary",onClick:w},{default:s(()=>e[6]||(e[6]=[F("确认修改",-1)])),_:1,__:[6]}),a(y,{size:"large",class:"cancel-btn",onClick:h},{default:s(()=>e[7]||(e[7]=[F("放弃修改",-1)])),_:1,__:[7]})],64))])],2)],2)}}}),J=M(G,[["__scopeId","data-v-999dbde0"]]);export{J as default};
