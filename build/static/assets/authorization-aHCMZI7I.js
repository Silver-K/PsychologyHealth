import{d as R,c as z,l as I,r as m,a as P,b as _,p as g,t as K,g as s,q as b,h as c,F as N,f as o,n as S,o as n,s as k,m as F,j as U,x as q,E as h,y as A}from"./index-B9CILD_j.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"authorization-page"},j={class:"title"},D={class:"btns"},L=R({__name:"authorization",setup(G){const f=U(),x=I(),d=z(()=>!x.query.modify_password),C=z(()=>d.value?"登入系统":"修改密码"),u=m({password:""}),t=m({newPassword:"",oldPassword:""}),i=m(),V=async()=>{i.value&&await i.value.validate(async p=>{if(!p)return;const{success:e,message:a}=await q(u.value);e?(await f.push("/"),i.value?.resetFields()):h({message:a,type:"error"})})},l=m(),w=async()=>{l.value&&await l.value.validate(async p=>{if(!p)return;const{success:e,message:a}=await A(t.value);e?(await f.back(),l.value?.resetFields()):h({message:a,type:"error"})})},B=async()=>{await f.back(),l.value?.resetFields()};return(p,e)=>{const a=c("ElInput"),v=c("ElFormItem"),E=c("ElForm"),y=c("ElButton");return n(),P("div",T,[_("div",{class:S(["login-box",{modify:!d.value}])},[_("h4",j,K(C.value),1),d.value?(n(),g(E,{key:0,ref_key:"formRef",ref:i,class:"form",model:u.value,"label-width":"auto",onSubmit:e[1]||(e[1]=b(()=>{},["prevent"]))},{default:s(()=>[o(v,{label:"",prop:"password"},{default:s(()=>[o(a,{size:"large",type:"password",placeholder:"密码","show-password":"",modelValue:u.value.password,"onUpdate:modelValue":e[0]||(e[0]=r=>u.value.password=r),onKeyup:k(V,["enter"])},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):(n(),g(E,{key:1,ref_key:"setFormRef",ref:l,class:"form",model:t.value,"label-width":"auto",onSubmit:e[4]||(e[4]=b(()=>{},["prevent"]))},{default:s(()=>[o(v,{label:"",prop:"oldPassword"},{default:s(()=>[o(a,{size:"large",type:"password",placeholder:"旧密码","show-password":"",modelValue:t.value.oldPassword,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.oldPassword=r),onKeyup:k(w,["enter"])},null,8,["modelValue"])]),_:1}),o(v,{label:"",prop:"newPassword"},{default:s(()=>[o(a,{size:"large",type:"password",placeholder:"新密码","show-password":"",modelValue:t.value.newPassword,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.newPassword=r),onKeyup:k(w,["enter"])},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),_("div",D,[d.value?(n(),g(y,{key:0,size:"large",class:"login-btn",type:"primary",onClick:b(V,["prevent"])},{default:s(()=>e[5]||(e[5]=[F("进入系统",-1)])),_:1,__:[5]})):(n(),P(N,{key:1},[o(y,{size:"large",class:"confirm-btn",type:"primary",onClick:w},{default:s(()=>e[6]||(e[6]=[F("确认修改",-1)])),_:1,__:[6]}),o(y,{size:"large",class:"cancel-btn",onClick:B},{default:s(()=>e[7]||(e[7]=[F("放弃修改",-1)])),_:1,__:[7]})],64))])],2)])}}}),O=M(L,[["__scopeId","data-v-c7897d01"]]);export{O as default};
