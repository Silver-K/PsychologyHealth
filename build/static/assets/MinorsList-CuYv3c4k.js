import{g as _,a as v,b as J,r as Q,c as X,m as Y}from"./minors-DKTootAl.js";import{t as Z,M as ee,m as te}from"./minors-DzstKTHx.js";import{g as oe}from"./table-B8sZ3RHj.js";import{M as ae,i as se,a as ne}from"./MinorInput-BZYUa3GX.js";import{d as M,r as m,c as re,B as le,a as b,f as o,b as x,C as ie,h as u,g as n,D as ue,o as h,m as l,u as ce,G as de,E as g,H as me,j as pe,I as fe}from"./index-BRyNBdtL.js";import{u as _e}from"./street-DRnnkt2p.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-DdpY_R0b.js";import"./MultiFileInput-B6XPHaqy.js";const ve={class:"minors-table"},ge={class:"dlg-body"},ye={class:"top"},be={key:0,class:"table"},y="whsg/stash/input-minor",he=M({__name:"MinorsTable",setup(I){const C=pe(),i=m([]),{streets:k,getNameByCommunityId:S,getNameByStreetId:V}=_e(),B=re(()=>!!k.length);async function T(){i.value=await v()}T();function A(e){C.push(`/detail/${e.id}`)}function D(e){return e.tempProtect?"取消庇护":"庇护"}const L=oe({keys:te.slice(),renderer:e=>{if(e==="tempProtect")return({rowData:t})=>o("span",null,[t.tempProtect?"是":"否"]);if(se(e)){const t=e==="street"?V:S;return({rowData:a})=>o("span",null,[t(a[e])])}else return ne(e)?({rowData:t})=>o("span",null,[Q.warningStatus[t[e]]]):void 0},width:150,titleObj:ee},{key:"indexor",title:"序号",width:100,cellRenderer({rowIndex:e}){return o("span",null,[e+1])}},{key:"operator",title:"操作",width:260,cellRenderer({rowData:e}){return o("div",null,[o("span",{class:"gap-12 text-primary text-hoverable-primary clickable",onClick:()=>A(e)},[l("查看")]),o("span",{class:"gap-12 text-primary text-hoverable-primary clickable",onClick:()=>H(e)},[l("删除")]),o("span",{class:"gap-12 text-primary text-hoverable-primary clickable",onClick:()=>K(e)},[D(e)])])}}),P=({rowData:e})=>e.tempProtect?"is-protect":"",c=m(!1),s=m(_());function N(){c.value=!0;const e=ue(y);e?s.value=e:s.value=_()}function w(){c.value=!1}function R(){s.value=_()}function j(){R(),w()}function U(){me(y)}function $(){de(y,s.value,"json")===0&&g.success("暂存成功")}async function z(){s.value=Z(s.value),await J(s.value)===0?(g({message:"录入成功",type:"success"}),w(),U()):g({message:"录入失败",type:"error"}),i.value=await v()}const p=m(""),F=le(async e=>{i.value=await v(e)}),d=()=>{F(p.value)};async function H(e){await fe.confirm("确定要删除该参与者吗？","删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const{id:t}=e;await X(t),d()}async function K(e){const{id:t}=e,a=i.value.find(f=>f.id===t);a&&(await Y(t,{tempProtect:!a.tempProtect}),d())}return(e,t)=>{const a=u("ElButton"),f=u("ElDialog"),O=u("ElInput"),G=u("ElTableV2"),W=u("ElAutoResizer");return h(),b("div",ve,[o(f,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=r=>c.value=r),title:"录入信息","close-on-click-modal":!1},{footer:n(()=>[o(a,{class:"opt-btn",onClick:j},{default:n(()=>t[3]||(t[3]=[l("放弃",-1)])),_:1,__:[3]}),o(a,{type:"warning",class:"opt-btn",onClick:$},{default:n(()=>t[4]||(t[4]=[l("暂存",-1)])),_:1,__:[4]}),o(a,{type:"primary",class:"opt-btn",onClick:z},{default:n(()=>t[5]||(t[5]=[l("提交",-1)])),_:1,__:[5]})]),default:n(()=>[x("div",ge,[o(ae,{"input-mode":"",form:s.value,"onUpdate:form":t[0]||(t[0]=r=>s.value=r)},null,8,["form"])])]),_:1},8,["modelValue"]),x("div",ye,[o(O,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=r=>p.value=r),type:"search",placeholder:"输入需要搜索的关键字",onChange:d},{append:n(()=>[o(a,{class:"search-enter",onClick:d},{default:n(()=>t[6]||(t[6]=[l("搜索",-1)])),_:1,__:[6]})]),_:1},8,["modelValue"]),o(a,{class:"record-btn",type:"primary",onClick:N},{default:n(()=>t[7]||(t[7]=[l("录入",-1)])),_:1,__:[7]})]),B.value?(h(),b("div",be,[o(W,null,{default:n(({width:r,height:q})=>[o(G,{class:"minors-table__inner",columns:ce(L),"row-class":P,data:i.value,width:r,height:q},null,8,["columns","data","width","height"])]),_:1})])):ie("",!0)])}}}),Ce=E(he,[["__scopeId","data-v-be109c20"]]),we={class:"card"},xe=M({__name:"MinorsList",setup(I){return(C,i)=>(h(),b("div",we,[o(Ce)]))}}),Le=E(xe,[["__scopeId","data-v-09e4b87b"]]);export{Le as default};
